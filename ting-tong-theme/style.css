/*
Theme Name: Ting Tong Theme
Theme URI: https://example.com/ting-tong-theme/
Author: Your Name
Author URI: https://example.com/
Description: A custom theme for the Ting Tong application, converted from a static HTML project.
Version: 1.0.0
License: GNU General Public License v2 or later
License URI: https://www.gnu.org/licenses/gpl-2.0.html
Text Domain: tingtongtheme
*/

/* ==========================================================================
           --- PRELOADER ---
           ========================================================================== */
#preloader {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: #000;
  z-index: 10000;
  transition: opacity 0.5s linear;
  overflow: hidden; /* Prevent layout issues */
}


.preloader-hiding {
  opacity: 0;
  pointer-events: none;
  z-index: -1; /* FIX: Ensure the preloader goes behind all content when hidden */
}

/* ============================================================================
   FIRST LOGIN MODAL - PREMIUM STYLES
   ============================================================================ */
.fl-modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.7);
  display: flex;
  align-items: flex-start; /* Wyrównuje zawartość do góry */
  justify-content: center;
  z-index: 10020;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.3s ease-out, visibility 0.3s ease-out;
  padding-top: var(--topbar-height); /* <--- ZMIANA: Dynamiczna pozycja pod topbarem */
}

.fl-modal-overlay.visible {
  opacity: 1;
  visibility: visible;
}

/* FIX: Container for better keyboard handling and to fill space correctly */
.fl-modal-content-wrapper {
  width: 100%;
  height: auto; /* <--- ZMIANA: Karta zajmuje tylko tyle miejsca, ile potrzebuje */
  display: flex;
  align-items: flex-start;
  justify-content: center;
  padding: 20px; /* Dodatkowy margines wokół karty */
}

/* ... reszta stylów fl-modal-content i fl-modal-content pozostaje bez zmian ... */

.fl-modal-content {
  transform: scale(0.95) translateY(20px);
  opacity: 0;
}

.fl-modal-overlay.visible .fl-modal-content {
    transform: scale(1) translateY(0);
    opacity: 1;
}

.fl-modal-content {
  background: linear-gradient(180deg, #242426 0%, #18181a 100%);
  border-radius: 24px;
  display: flex;
  flex-direction: column;
  height: auto;
  max-height: calc(100vh - 80px); /* <-- ZMIANA: Więcej miejsca, z marginesami */
  width: 100%;
  max-width: 500px;
  /* ... (pozostałe style) ... */
}

.fl-header {
  padding: 12px 24px 16px;
  flex-shrink: 0;
}

.fl-drag-handle-container {
  padding-bottom: 12px;
  display: flex;
  justify-content: center;
}

.fl-drag-handle {
  width: 40px;
  height: 5px;
  background: #48484a;
  border-radius: 2.5px;
}

.fl-title {
  color: #fff;
  text-align: center;
  font-size: 22px;
  font-weight: 700;
  margin-bottom: 16px;
}

.fl-progress-bar-container {
  height: 6px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 3px;
}

.fl-progress-bar-fill {
  height: 100%;
  width: 33.33%;
  background: linear-gradient(90deg, #34d058, #007aff); /* FIX: Optymistyczny akcent - zieleń i błękit */
  border-radius: 3px;
  transition: width 0.4s ease;
}

.fl-body {
  padding: 0 24px 20px;
  overflow-y: auto;
  flex-grow: 1;
}

.fl-step {
  display: none;
}

.fl-step.active {
  display: block;
  animation: fadeIn 0.5s ease;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

.fl-step-description {
  color: #b0b3b8;
  font-size: 16px;
  line-height: 1.5;
  margin-bottom: 24px;
  text-align: center;
}

.fl-fields-container {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.fl-input {
  background: rgba(255, 255, 255, 0.08);
  border: 1px solid rgba(255, 255, 255, 0.15);
  padding: 14px 16px;
  border-radius: 12px;
  color: #fff;
  font-size: 16px;
  transition: all 0.2s ease;
}

.fl-input:focus {
  outline: none;
  border-color: var(--accent-color);
  background: rgba(255, 255, 255, 0.1);
  box-shadow: 0 0 0 3px rgba(255, 0, 85, 0.15);
}

.fl-input::placeholder {
  color: #8e8e93;
}

.fl-preference-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: rgba(255, 255, 255, 0.08);
  padding: 14px 16px;
  border-radius: 12px;
  cursor: pointer;
}

.fl-preference-label {
  color: #fff;
  font-size: 16px;
  font-weight: 500;
}

.fl-checkbox {
  transform: scale(1.4);
  accent-color: var(--accent-color);
}

.fl-language-selector {
  display: none; /* Hidden by default, shown by JS */
  gap: 10px;
  background: rgba(255, 255, 255, 0.08);
  padding: 6px;
  border-radius: 12px;
}

.fl-language-selector.visible {
    display: flex;
}

.fl-language-option {
  flex: 1;
  padding: 10px 16px;
  border-radius: 8px;
  color: #b0b3b8;
  font-weight: 600;
  cursor: pointer;
  border: none;
  background: transparent;
  transition: all 0.2s ease;
}

.fl-language-option.active {
  background: var(--accent-color);
  color: #fff;
  box-shadow: 0 4px 12px rgba(255, 0, 85, 0.3);
}

.fl-hint-text {
  font-size: 13px;
  color: #888;
  text-align: center;
  margin-top: 4px;
}

.fl-email-display {
  display: block;
  background: rgba(255, 255, 255, 0.08);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 12px;
  padding: 14px 16px;
  color: #fff;
  font-weight: 500;
  text-align: center;
}

.fl-footer {
  padding: 16px 24px;
  background: #18181a;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  padding-bottom: calc(16px + var(--safe-area-bottom));
}

.fl-footer-buttons {
  display: flex;
  gap: 12px;
}

.fl-btn {
  flex: 1;
  padding: 16px;
  border: none;
  border-radius: 14px;
  font-size: 16px;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.2s ease;
}

.fl-btn:active {
  transform: scale(0.97);
}

.fl-btn-prev {
  background: #3a3a3c;
  color: #fff;
  display: none; /* Hidden by default */
}

.fl-btn-next {
  background: linear-gradient(90deg, #007aff, #0056b3);
  color: #fff;
  box-shadow: 0 4px 12px rgba(0, 122, 255, 0.3);
}

.fl-btn-submit {
  background: linear-gradient(90deg, #34c759, #28a745);
  color: #fff;
  display: none; /* Hidden by default */
  box-shadow: 0 4px 12px rgba(52, 199, 89, 0.3);
}

/* --- Tipping Modal Specific Styles --- */

.tipping-amount-container {
    display: flex;
    align-items: center;
    background-color: #2c2c2e;
    border-radius: 12px;
    padding: 4px;
    border: 1px solid #4d4d50;
    transition: border-color 0.2s;
}

.tipping-amount-container:focus-within {
    border-color: var(--accent-color);
    box-shadow: 0 0 0 3px rgba(255, 0, 85, 0.15);
}

#tippingAmount {
    flex-grow: 1;
    background: transparent;
    border: none;
    color: white;
    font-size: 28px;
    font-weight: bold;
    padding: 12px 16px;
    text-align: center;
    -moz-appearance: textfield; /* Firefox */
}

#tippingAmount::-webkit-outer-spin-button,
#tippingAmount::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
}

.tipping-currency {
    font-size: 24px;
    font-weight: bold;
    color: rgba(255, 255, 255, 0.6);
    padding-right: 20px;
}

#tippingEmailContainer {
    transition: all 0.3s ease-in-out;
    opacity: 0;
    max-height: 0;
    overflow: hidden;
}

#tippingEmailContainer.visible {
    opacity: 1;
    max-height: 100px; /* enough for input and hint */
    margin-top: 16px;
}

.loading-spinner.large {
    width: 48px;
    height: 48px;
    border-width: 4px;
}
.preloader-icon-container {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 192px;
  height: 192px;
}
.splash-icon {
  width: 100%;
  height: 100%;
  object-fit: contain;
  animation: pulse-glow 2.5s infinite ease-in-out;
}
@keyframes pulse-glow {
  0% {
    transform: scale(1);
    opacity: 0.9;
  }
  50% {
    transform: scale(1.03);
    opacity: 1;
  }
  100% {
    transform: scale(1);
    opacity: 0.9;
  }
}
.preloader-content-container {
  position: absolute;
  top: calc(50% + 96px); /* 96px is half of the icon's 192px height */
  bottom: 0;
  left: 0;
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center; /* FIX: Vertically center content in the available space */
  overflow-y: auto; /* FIX: Allow scrolling on extremely small screens as a safeguard */
  padding: 10px 20px calc(15px + var(--safe-area-bottom));
  box-sizing: border-box;
  opacity: 0;
  transform: translateY(100%);
  transition:
    transform 1s cubic-bezier(0.68, -0.55, 0.27, 1.55),
    opacity 0.6s ease-out,
    padding 0.3s ease-out;
}
.preloader-content-container::-webkit-scrollbar {
  display: none;
}
.preloader-content-container {
  -ms-overflow-style: none;
  scrollbar-width: none;
}
#preloader.content-visible .preloader-content-container {
  opacity: 1;
  transform: translateY(0);
}
.language-selection {
  margin-top: 0; /* FIX: Remove margin, as justify-content now handles vertical position */
  text-align: center;
  width: 100%;
  max-width: 400px;
  flex-shrink: 0; /* FIX: Prevent shrinking on flex parent */
}
.language-selection h2 {
  font-size: clamp(1.1rem, 3vh, 1.3rem); /* Approx 17.6px to 20.8px */
  font-weight: 600;
  color: #fff;
  margin-bottom: clamp(10px, 3vh, 20px);
  text-shadow: 0 2px 8px rgba(0, 0, 0, 0.7);
  transition:
    font-size 0.3s ease-out,
    margin-bottom 0.3s ease-out;
}
.language-selection .lang-buttons-container {
  display: flex;
  flex-direction: column;
  gap: clamp(8px, 2vh, 15px);
  width: 100%;
  justify-content: center;
  transition: gap 0.3s ease-out;
}
@keyframes subtle-flicker-glow {
  0% {
    box-shadow: 0 0 0 0 rgba(255, 64, 129, 0.7);
  }
  50% {
    box-shadow: 0 0 16px 8px rgba(255, 64, 129, 0.3);
  }
  100% {
    box-shadow: 0 0 0 0 rgba(255, 64, 129, 0);
  }
}
.language-selection button {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: white;
  padding: clamp(8px, 2vh, 16px) clamp(18px, 3vw, 24px);
  margin: 0;
  font-size: clamp(0.875rem, 2.2vh, 1.125rem); /* Approx 14px to 18px */
  font-weight: 600;
  border-radius: clamp(12px, 2vh, 16px);
  cursor: pointer;
  width: 100%;
  max-width: 400px;
  transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  -webkit-tap-highlight-color: transparent;
}
.language-selection button:hover:not(:disabled) {
  transform: translateY(-2px);
  border-color: rgba(255, 255, 255, 0.5);
}
.language-selection button:active:not(:disabled) {
  transform: translateY(-1px) scale(0.98);
  transition-duration: 0.1s;
}
.language-selection button.is-selected {
  background-color: var(--accent-color);
  border-color: var(--accent-color);
  color: #fff;
  animation: subtle-flicker-glow 1s ease-out;
}
.language-selection button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* ==========================================================================
           --- STYLE GŁÓWNE, RESET I SCROLLING ---
           ========================================================================== */
:root {
  --app-height: 100%;
  --accent-color: #ff0055;
  --progress-bar-color: var(--accent-color);
  --main-ui-bg-color: #696969;
  --transition-speed: 0.4s;
  --transition-timing: cubic-bezier(0.25, 0.46, 0.45, 0.94);
  --topbar-base-height: 40px;
  --bottombar-base-height: 110px;
  --safe-area-top: env(safe-area-inset-top);
  --safe-area-bottom: env(safe-area-inset-bottom);
  --topbar-height: calc(var(--topbar-base-height) + var(--safe-area-top));
  --bottombar-height: calc(
    var(--bottombar-base-height) + var(--safe-area-bottom)
  );
}
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  -webkit-tap-highlight-color: transparent;
}
html,
body {
  height: 100%;
  width: 100%;
  overflow: hidden;
  font-family:
    -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial,
    sans-serif;
  background-color: #000;
  color: white;
  overscroll-behavior: none; /* Prevent bounce scroll and pull-to-refresh on iOS */
  user-select: none;
  -webkit-user-select: none;
}
body::-webkit-scrollbar,
#webyx-container::-webkit-scrollbar {
  display: none;
}
body,
#webyx-container {
  -ms-overflow-style: none; /* IE and Edge */
  scrollbar-width: none; /* Firefox */
}
#webyx-container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  opacity: 0; /* Hidden initially */
  transition: opacity 0.5s linear;
  overflow: hidden; /* Swiper handles overflow */
  /* Wymuszenie własnej warstwy GPU na całym kontenerze Swipera */
  -webkit-transform: translate3d(0, 0, 0); /* Stabilizacja kontenera */
  transform: translate3d(0, 0, 0);
}
#webyx-container.ready {
  opacity: 1;
}
.webyx-section {
  width: 100vw;
  height: var(--app-height); /* Use var, remove 1px patch for scroll-snap */
  overflow: hidden;
  position: relative;
}

/* Wymuszenie własnej warstwy kompozycji dla każdego slajdu */
.webyx-section,
.swiper-slide {
  -webkit-transform: translate3d(0, 0, 0) !important;
  transform: translate3d(0, 0, 0) !important;
  /* Dodanie backface-visibility poprawia zachowanie przy transformacjach 3D */
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
  will-change: transform;
}

/* Upewnij się, że wrapper Swipera ma transformację 3D */
.swiper-wrapper {
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
}

/* ==========================================================================
           --- GŁÓWNY LAYOUT (TIKTOK-LIKE) ---
           ========================================================================== */
.tiktok-symulacja {
  position: relative;
  width: 100%;
  height: 100%;
  overflow: hidden;
  background-color: black;
  color: white;
  z-index: 1;
  font-family: "Manrope", sans-serif;
}
.tiktok-symulacja iframe {
  width: 100%;
  height: 100%;
  border: none;
  pointer-events: none !important;
}
.tiktok-symulacja * {
  box-sizing: border-box;
  -webkit-tap-highlight-color: transparent;
}
.secret-overlay {
  position: absolute;
  top: var(--topbar-height);
  left: 0;
  width: 100%;
  height: calc(100% - var(--topbar-height) - var(--bottombar-height));
  background: rgba(0, 0, 0, 0.4);
  -webkit-backdrop-filter: blur(12px) saturate(120%);
  backdrop-filter: blur(12px) saturate(120%);
  z-index: 100;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  text-align: center;
  padding: 20px;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.4s ease, top 0.3s ease-out, height 0.3s ease-out;
}
.secret-overlay.visible {
  opacity: 1;
  pointer-events: auto;
}
.secret-overlay .secret-icon {
  width: 64px;
  height: 64px;
  margin-bottom: 24px;
  color: rgba(255, 255, 255, 0.9);
  filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.4));
}
.secret-overlay .secret-title {
  font-size: 24px;
  font-weight: 700;
  color: #fff;
  margin-bottom: 4px;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
}
.secret-overlay .secret-subtitle {
  font-size: 16px;
  color: rgba(255, 255, 255, 0.8);
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
}
.pwa-secret-overlay {
  position: absolute;
  top: var(--topbar-height);
  left: 0;
  width: 100%;
  height: calc(100% - var(--topbar-height) - var(--bottombar-height));
  background: rgba(0, 0, 0, 0.4);
  -webkit-backdrop-filter: blur(12px) saturate(120%);
  backdrop-filter: blur(12px) saturate(120%);
  z-index: 100;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  text-align: center;
  padding: 20px;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.4s ease, top 0.3s ease-out, height 0.3s ease-out;
}
.pwa-secret-overlay.visible {
  opacity: 1;
  pointer-events: auto;
}
.pwa-secret-overlay .pwa-secret-icon,
.pwa-secret-overlay .secret-icon {
  width: 64px;
  height: 64px;
  margin-bottom: 24px;
  color: rgba(255, 255, 255, 0.9);
  filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.4));
}
.pwa-secret-overlay .pwa-secret-title {
  font-size: 22px;
  font-weight: 700;
  color: #fff;
  margin-bottom: 4px;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
}
.pwa-secret-overlay .pwa-secret-subtitle {
  font-size: 16px;
  color: rgba(255, 255, 255, 0.8);
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
}
.player {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  transform: translate3d(0, 0, 0); /* Fix for video flickering on iOS */
}
.pause-overlay {
  position: absolute;
  top: var(--topbar-height);
  left: 0;
  width: 100%;
  height: calc(100% - var(--topbar-height) - var(--bottombar-height));
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: transparent; /* Zmień kolor na przeźroczysty */
  z-index: 101;
  opacity: 0;
  pointer-events: none;
  transition: top 0.3s ease-out, height 0.3s ease-out, opacity 0.2s ease-in-out;
  visibility: hidden;
}
.tiktok-symulacja:not(.video-loaded) .pause-overlay {
  display: none !important;
}
.pause-overlay.visible {
  opacity: 1;
  pointer-events: auto;
  visibility: visible;
}
.pause-icon {
  width: 80px;
  height: 80px;
  color: rgba(255, 255, 255, 0.8);
  filter: drop-shadow(0 0 10px rgba(0, 0, 0, 0.5));
}

/* ✅ NOWE: Replay overlay */
.replay-overlay {
  position: absolute;
  top: var(--topbar-height);
  left: 0;
  width: 100%;
  height: calc(100% - var(--topbar-height) - var(--bottombar-height));
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: transparent;
  z-index: 101;
  opacity: 0;
  pointer-events: none;
  transition: top 0.3s ease-out, height 0.3s ease-out, opacity 0.2s ease-in-out;
  visibility: hidden;
}

.tiktok-symulacja:not(.video-loaded) .replay-overlay {
  display: none !important;
}

.replay-overlay.visible {
  opacity: 1;
  pointer-events: auto;
  visibility: visible;
}

.replay-icon {
  width: 80px;
  height: 80px;
  color: rgba(255, 255, 255, 0.9);
  filter: drop-shadow(0 0 12px rgba(0, 0, 0, 0.6));
  animation: replayPulse 2s ease-in-out infinite;
}

@keyframes replayPulse {
  0%, 100% {
    transform: scale(1);
    opacity: 0.9;
  }
  50% {
    transform: scale(1.1);
    opacity: 1;
  }
}


/* ✅ FIX 2: Kontrolki wideo w poziomie, bliżej lewej krawędzi */
.video-controls {
  position: absolute;
  bottom: calc(var(--bottombar-height) + 8px);
  left: 4px; /* Odsunięcie od lewej krawędzi */
  right: 4px; /* Odsunięcie od prawej krawędzi */
  width: auto; /* Szerokość auto, aby dopasować się do lewej i prawej */
  z-index: 105;
  display: flex;
  flex-direction: row; /* Układ poziomy */
  align-items: center;
  justify-content: space-between; /* Kluczowe dla rozmieszczenia */
  opacity: 0;
  transition: opacity 0.6s ease-out;
}

.tiktok-symulacja.video-loaded .video-controls {
    opacity: 1;
}

.video-controls-left {
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 4px; /* Odstęp między przyciskami po lewej */
}

.video-controls button {
  background: rgba(0, 0, 0, 0.5);
  border: none;
  border-radius: 50%;
  width: 34px; /* Zmniejszono */
  height: 34px; /* Zmniejszono */
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s, opacity 0.3s ease-out;
  padding: 0;
  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px);
}

.video-controls button svg {
  width: 18px; /* Zmniejszono */
  height: 18px; /* Zmniejszono */
  transition: fill 0.3s ease-out, stroke 0.3s ease-out;
}

.video-controls button:hover {
  background: rgba(0, 0, 0, 0.7);
}

.video-controls button:active {
  transform: scale(0.9);
}

.cc-button {
  cursor: not-allowed;
  opacity: 0.5;
}
.topbar {
  background: #000;
}
.tiktok-symulacja .bottombar {
  background: rgba(0, 0, 0, 0.7); /* Półprzezroczyste czarne tło dla lepszej czytelności */
}
.login-panel {
  background: rgba(0, 0, 0, 0.6);
  -webkit-backdrop-filter: blur(8px);
  backdrop-filter: blur(8px);
}
.topbar {
  position: absolute; /* Zmienione z 'fixed' na 'absolute' */
  display: flex;
  justify-content: center;
  align-items: center;
  text-shadow:
    -1px -1px 0 black,
    1px -1px 0 black,
    -1px 1px 0 black,
    1px 1px 0 black;
  top: 0;
  left: 0;
  width: 100%; /* teraz 100% szerokości #app-frame */
  height: var(--topbar-height);
  padding-top: var(--safe-area-top);
  z-index: 115;
  font: inherit;
  color: inherit;
  border-bottom: 1px solid rgba(255, 255, 255, 0.15);
  transition: border-color 0.3s ease-out;
}

/* Stabilizacja kluczowych elementów interfejsu (topbar, sidebar, bottombar) */
.topbar,
.tiktok-symulacja .sidebar,
.tiktok-symulacja .bottombar {
  /* Wymuszenie własnej, stabilnej warstwy GPU dla stałych elementów */
  -webkit-transform: translateZ(0);
  transform: translateZ(0);
}
.topbar.login-panel-active {
  border-bottom-color: transparent;
}
.topbar.login-panel-active .central-text-wrapper.with-arrow::after {
  transform: translateY(-50%) rotate(180deg);
}
.central-text-wrapper {
  position: relative;
}
.topbar-text {
  font-size: 16px;
  font-weight: 600;
  color: white;
  pointer-events: none;
}
.central-text-wrapper.with-arrow::after {
  content: "▼";
  position: absolute;
  left: 100%;
  top: 50%;
  transform: translateY(-50%);
  font-size: 12px;
  opacity: 0.8;
  margin-left: 6px;
  transition: transform 0.3s ease;
}
.tiktok-symulacja .sidebar {
  position: absolute;
  top: calc(
    (var(--app-height) - var(--topbar-height) - var(--bottombar-height)) / 2 +
      var(--topbar-height)
  );
  right: 2px;
  transform: translateY(-50%) translateX(100%);
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 6px;
  z-index: 10052;
  opacity: 0;
  transition:
    top 0.3s ease-out,
    opacity 0.6s ease-out,
    transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.tiktok-symulacja.video-loaded .sidebar {
  opacity: 1;
  transform: translateY(-50%) translateX(0);
}
.tiktok-symulacja .bottombar {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  height: var(--bottombar-base-height); /* ✅ Zmieniono na stałą wysokość */
  display: flex;
  flex-direction: column;
  justify-content: flex-start; /* ✅ Wyrównaj zawartość do góry */
  padding: 15px 75px 10px 12px; /* ✅ Zwiększony górny padding */
  color: white;
  z-index: 10050;
  padding-bottom: calc(10px + var(--safe-area-bottom));
  opacity: 0;
  transition: opacity 0.6s ease-out;
}

/* ✅ NOWE: Pokaż bottombar dopiero gdy video jest załadowane */
.tiktok-symulacja.video-loaded .bottombar {
  opacity: 1;
}

/* Dodaj tę regułę, aby dostosować dolny pasek, gdy widoczony jest pasek instalacji PWA */
.app-frame--pwa-visible .bottombar {
}
/* === PATCH: Pasek progressu na górnej krawędzi bottombar (v2 - Pixel Perfect) === */

/* 1. Zmień pozycjonowanie i wysokość - progress bar ma być częścią bottombar */
.progress-bar {
  position: absolute;
  bottom: 100%; /* Na górnej krawędzi bottombar */
  left: 0;
  width: 100%;
  height: 4px; /* Zmniejszona wysokość, aby zlikwidować przerwę */
  cursor: pointer;
  -webkit-tap-highlight-color: transparent;
  z-index: 10060; /* Podniesiony, aby był nad paskiem PWA */
  transition: height 0.2s ease-in-out;
  transform: translateY(2px); /* Przesunięcie w dół o 2px */
}

/* 2. Usuń stare reguły dla app-frame--pwa-visible - pozostaje bez zmian */
.app-frame--pwa-visible .progress-bar {
  top: unset;
  bottom: 100%;
}

/* 3. Dla przeglądarki (nie-PWA) - usuń transform - pozostaje bez zmian */
@media not all and (display-mode: standalone) {
  .progress-bar {
    bottom: 100%;
    top: auto;
    transform: translateY(2px); /* Przesunięcie w dół o 2px */
  }
}

/* 4. Dostosuj pseudo-elementy do nowej wysokości kontenera */
.progress-bar::before {
  content: "";
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%; /* Wypełnia całą wysokość kontenera */
  background-color: rgba(255, 0, 85, 0.3);
}

.progress-bar-fill {
  position: absolute;
  left: 0;
  top: 0;
  width: 0%;
  height: 100%; /* Wypełnia całą wysokość kontenera */
  background-color: var(--progress-bar-color);
  border-radius: 2px;
  pointer-events: none;
}

.progress-bar-handle {
  position: absolute;
  top: 50%; /* Pozostaje wycentrowany w pionie */
  left: 0%;
  width: 12px;
  height: 12px;
  border-radius: 50%;
  background-color: white;
  transform: translate(-50%, -50%) scale(1);
  transition: transform 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  opacity: 1;
  pointer-events: none;
  box-shadow: 0 0 8px rgba(0, 0, 0, 0.5);
  z-index: 10; /* FIX: Zapewnia, że uchwyt jest nad innymi elementami w progress-bar */
}

/* 5. Zmień sposób obsługi hover - powiększamy cały kontener */
.progress-bar:hover,
.progress-bar.dragging {
  height: 6px; /* Zwiększamy wysokość całego paska */
}

.progress-bar:hover .progress-bar-handle,
.progress-bar.dragging .progress-bar-handle {
  transform: translate(-50%, -50%) scale(1.5);
}

.tiktok-symulacja .text-info {
  display: flex;
  flex-direction: column;
  min-width: 0;
}

.tiktok-symulacja .slide-meta-line {
  display: flex;
  align-items: center; /* Lepsze wyrównanie w pionie */
  gap: 8px;
  width: 100%;
  overflow: hidden; /* Zapobiegaj przepełnieniu */
}

.tiktok-symulacja .author-name {
  font-size: 16px;
  font-weight: 700; /* Używamy <strong>, więc pogrubiamy */
  color: white;
  text-shadow: 0 0 4px rgba(0, 0, 0, 0.8);
  /* NOWE: Pozwól na skracanie i dodaj wielokropek, aby uniknąć przepełnienia */
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  min-width: 0;
}

.tiktok-symulacja .slide-title {
  font-size: 16px;
  font-weight: 400; /* Zwykła waga dla kontrastu */
  line-height: 1.2;
  text-shadow: 0 0 4px rgba(0, 0, 0, 0.8);
  white-space: nowrap; /* Nie zawijaj tekstu */
  overflow: hidden; /* Ukryj przepełnienie */
  text-overflow: ellipsis; /* Dodaj wielokropek */
  min-width: 0; /* Pozwól na zmniejszenie */
}

.tiktok-symulacja .slide-description {
  font-size: 14px;
  line-height: 1.4;
  color: white;
  text-shadow: 0 0 4px rgba(0, 0, 0, 0.8);
  margin-top: 4px;
  /* Ograniczenie do 2 linii z wielokropkiem */
  overflow: hidden;
  text-overflow: ellipsis;
  display: -webkit-box;
  -webkit-line-clamp: 2; /* Ogranicz do 2 linii */
  -webkit-box-orient: vertical;
  white-space: normal;
}

/* ==========================================================================
           --- KOMPONENTY UI: PRZYCISKI I IKONY ---
           ========================================================================== */
.tiktok-symulacja .profile {
  position: relative;
  width: 50px;
  height: 50px;
  margin-bottom: 6px;
}
.tiktok-symulacja .profileButton {
  background: none;
  border: none;
  padding: 0;
  border-radius: 50%;
  cursor: pointer;
  display: block;
  width: 100%;
  height: 100%;
  transition: transform 0.15s ease-out;
}
.tiktok-symulacja .profileButton:active {
  transform: scale(1.15);
  transition: none;
}
.tiktok-symulacja .profile img {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  border: 2px solid white;
  display: block;
  transition:
    border-color 0.1s ease-in-out,
    filter 0.2s;
  background-color: white; /* Dodane białe tło */
}

/* Styl dla obwódki VIP */
@keyframes spin-gradient {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

.vip-avatar-border {
  position: relative;
  border: none !important; /* Usuwamy standardową ramkę */
  padding: 2px; /* Tworzymy przestrzeń na nową "ramkę" */
  background-clip: content-box !important; /* Tło tylko pod obrazkiem */
  box-shadow: 0 0 12px rgba(255, 215, 0, 0.7); /* Złota poświata */
}

.vip-avatar-border::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  border-radius: 50%;
  border: 2px solid transparent;
  background: conic-gradient(from 0deg, gold, #ffeb3b, #ffc107, #ffeb3b, gold) border-box;
  -webkit-mask:
    linear-gradient(#fff 0 0) content-box,
    linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor;
          mask-composite: exclude;
  animation: spin-gradient 2s linear infinite;
}
.tiktok-symulacja .profileButton:active img {
  border-color: var(--accent-color);
}
.tiktok-symulacja .plus {
  position: absolute;
  bottom: -6px;
  left: 50%;
  transform: translateX(-50%);
  background: var(--accent-color);
  color: white;
  border: 2px solid white;
  border-radius: 50%;
  width: 20px;
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  font-size: 18px;
  line-height: 1;
  pointer-events: none;
  transition: border-color 0.1s ease-in-out;
}
.tiktok-symulacja.is-logged-in .profile .plus {
  display: none;
}
.tiktok-symulacja .profileButton:active + .plus {
  border-color: var(--accent-color);
}
.tiktok-symulacja .icon-button {
  background: none;
  border: none;
  font: inherit;
  color: inherit;
  display: flex;
  flex-direction: column;
  align-items: center;
  cursor: pointer;
  font-size: 11px;
  transition: transform 0.2s ease-out, opacity 0.2s ease-out;
  gap: 2px;
}
.tiktok-symulacja .icon-button:focus,
.tiktok-symulacja .profileButton:focus {
  outline: none;
}
.tiktok-symulacja .icon-button:active:not(:disabled) {
  transform: scale(1.15);
  transition: none;
}
.tiktok-symulacja .icon-button svg {
  width: 32px;
  height: 32px;
  stroke: white;
  stroke-width: 1.5;
  fill: none;
  transition:
    stroke 0.2s ease-in-out,
    fill 0.2s ease-in-out;
  pointer-events: none;
  padding: 0;
  margin: 0;
  display: block;
  filter: drop-shadow(0 0 3px rgba(0, 0, 0, 0.5));
}
.tiktok-symulacja .icon-button .icon-label {
  margin: 0;
  padding: 0;
  text-align: center;
  line-height: 1.1;
  transition: color 0.2s ease-in-out;
  text-shadow: 0 0 4px rgba(0, 0, 0, 0.8);
}
.tiktok-symulacja .like-button.active > svg {
  fill: var(--accent-color);
  stroke: white;
}
.tiktok-symulacja .like-button:active:not([disabled]) {
  transform: scale(1.2);
}
.tiktok-symulacja .tipButton {
  width: 64px;
  margin-top: 0;
  flex-shrink: 0;
}
.tiktok-symulacja .like-button:active:not(:disabled) svg {
  stroke: white !important;
}
.topbar-central-trigger {
  background: none;
  border: none;
  padding: 0;
  margin: 0;
  font: inherit;
  color: inherit;
  cursor: pointer;
  display: flex;
  justify-content: center;
}
.topbar-central-trigger:active {
  transform: scale(0.98);
}
.topbar-icon-btn {
  position: absolute;
  background: none;
  border: none;
  padding: 0;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 40px;
  height: 40px;
  flex-shrink: 0;
  transition:
    transform 0.1s ease-in-out,
    opacity 0.2s;
  /* ✅ FIX: Center vertically considering safe area */
  top: calc(var(--safe-area-top) + (var(--topbar-base-height) / 2));
  transform: translateY(-50%);
}
.hamburger-icon {
  left: 0;
}
.notification-bell {
  right: 0;
}
.topbar-icon-btn:active:not([disabled]) {
  transform: translateY(-50%) scale(0.9);
}
.topbar-icon-btn[disabled] {
  opacity: 0.5;
  cursor: not-allowed;
  transform: translateY(-50%) scale(1);
}
.hamburger-icon svg {
  stroke: white;
  stroke-width: 2.5;
  stroke-linecap: round;
  fill: none;
}
.notification-bell svg {
  stroke: white;
  fill: none;
}
.notification-dot {
  position: absolute;
  top: 10px;
  right: 11px;
  width: 8px;
  height: 8px;
  background-color: var(--accent-color);
  border-radius: 50%;
  border: 2px solid white;
}

/* ==========================================================================
           --- KOMPONENTY UI: PANELE I MENU ---
           ========================================================================== */
.login-panel {
  position: absolute;
  top: var(--topbar-height);
  left: 0;
  width: 100%;
  color: white;
  z-index: 110 !important;
  border-top: none;
  transform: translateY(-100%);
  opacity: 0;
  pointer-events: none;
  transition:
    transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94),
    opacity 0.3s ease-out;
}
.login-panel.active {
  transform: translateY(0);
  opacity: 1;
  pointer-events: auto;
}
.login-panel > div,
.login-panel > form {
  padding: 10px 15px;
  background: transparent !important;
}
.login-panel .login-form {
  background: white;
  padding: 10px 20px 20px;
  border-radius: 8px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  width: 100%;
  max-width: 400px;
  margin: -9px auto 0;
}

/* === LOGIN PANEL NEW STYLE === */
.login-panel .login-form .password-wrapper {
  position: relative;
  width: 100%;
  display: flex;
  align-items: center;
}

.login-panel .login-form input[type="text"],
.login-panel .login-form input[type="password"] {
  background: white;
  border: 2px solid black;
  font-weight: bold;
  color: black;
  padding: 8px 40px 8px 10px; /* Add padding to the right for the icon */
  border-radius: 4px;
  width: 100%;
  font-size: 16px;
}

.password-toggle-btn {
  position: absolute;
  right: 0;
  top: 0;
  height: 100%;
  width: 40px;
  background: transparent;
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  opacity: 1; /* Make fully opaque */
  transition: transform 0.2s;
}

.password-toggle-btn:hover {
  transform: scale(1.1);
}

.password-toggle-btn svg {
  width: 22px; /* Slightly larger */
  height: 22px; /* Slightly larger */
  fill: black; /* Use fill for solid icons */
  stroke: none; /* No stroke needed */
}

.login-panel .login-form button[type="submit"] {
  background: var(--accent-color);
  border: none;
  width: 100%;
  padding: 10px;
  font-weight: bold;
  color: white;
  text-transform: uppercase;
  font-family: inherit;
  cursor: pointer;
  -webkit-appearance: none;
  appearance: none;
  border-radius: 4px;
  font-size: 16px;
}

.login-panel .login-form button[type="submit"]:active {
  background: #222;
}

.logged-in-menu {
  position: absolute;
  top: var(--topbar-height);
  left: 0;
  z-index: 110;
  background-color: rgba(20, 20, 20, 0.85);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border-bottom-right-radius: 12px;
  overflow: hidden;
  max-height: 0;
  transition: max-height 0.3s ease;
  display: flex;
  flex-direction: column;
  border: none; /* Removed border */
}
.logged-in-menu.active {
  max-height: 200px;
}
.logged-in-menu a {
  color: white;
  text-decoration: none;
  padding: 12px 24px 12px 16px;
  font-size: 16px;
  text-align: left;
  white-space: nowrap;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  transition: background-color 0.2s ease;
}
.logged-in-menu a:last-child {
  border-bottom: none;
}
.logged-in-menu a:hover,
.logged-in-menu a:focus {
  background: rgba(255, 255, 255, 0.1);
  outline: none;
}

/* ==========================================================================
           --- KOMPONENTY UI: MODALE I ALERTY ---
           ========================================================================== */
#alertBox {
  /* ✅ FIX: Zmieniono na position:fixed aby zapewnić widoczność w PWA */
  position: fixed;
  /* ✅ FIX: Obniżono pozycję bliżej dolnego paska */
  bottom: calc(var(--bottombar-height) + 4px);
  left: 50%;
  transform: translateX(-50%);
  transition: bottom 0.3s ease-out;

  background-color: #000000;
  color: white;
  padding: 12px 20px;
  border-radius: 24px;
  font-size: 14px;
  font-weight: 500;
  display: none;
  align-items: center;
  justify-content: center;
  gap: 10px;
  z-index: 10001; /* Podniesiony z-index */
  white-space: nowrap; /* ✅ FIX: Wymuś jedną linię dla krótkich tekstów */

  /* ✅ FIX: Szerokość dopasowana do treści, z marginesami */
  width: fit-content;
  max-width: calc(100vw - 40px); /* Maksymalna szerokość z marginesami po 20px */

  box-shadow: 0 4px 15px rgba(0,0,0,0.5);
  border: 1px solid #000;
  animation: fadeInOut 4s ease-in-out forwards;
  box-sizing: border-box;
  text-align: center;
}

#app-frame.hide-ui #alertBox {
  /* ✅ FIX: Dostosowano pozycję w trybie immersyjnym */
  bottom: calc(var(--safe-area-bottom) + 12px);
}

#alertBox svg {
    width: 22px;
    height: 22px;
    flex-shrink: 0;
}

#alertText {
    display: block;
    min-width: 0;
    flex-grow: 1;
    white-space: normal; /* ✅ FIX: Pozwól długim tekstom na zawijanie */
}

#alertBox.visible {
  display: flex;
}
@keyframes fadeInOut {
  0% {
    opacity: 0;
    transform: translate(-50%, 10px);
  }
  10% {
    opacity: 1;
    transform: translate(-50%, 0);
  }
  90% {
    opacity: 1;
    transform: translate(-50%, 0);
  }
  100% {
    opacity: 0;
    transform: translate(-50%, 10px);
  }
}
.modal-overlay,
.fl-modal-overlay,
#commentsModal,
.account-modal-overlay,
#tiktok-profile-modal,
.crop-modal,
.image-lightbox {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.7);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10200;
  opacity: 0;
  visibility: hidden;
  transition:
    opacity 0.3s ease-out,
    visibility 0.3s ease-out;
}
.modal-overlay.visible {
  opacity: 1;
  visibility: visible;
}
.modal-content {
  z-index: 2001;
  position: relative;
  /* Generic transition for modals that fade/scale */
  transition: transform 0.3s ease-out, opacity 0.3s ease-out;
}

/* Default state for modals that just fade/scale */
.modal-overlay:not(#comments-modal-container) .modal-content {
  opacity: 0;
  transform: scale(0.95);
}

.modal-overlay.visible:not(#comments-modal-container) .modal-content {
    opacity: 1;
    transform: scale(1);
}

.modal-close-btn {
  position: absolute;
  top: 8px;
  right: 8px;
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: none;
  border: none;
  font-size: 28px;
  line-height: 1;
  cursor: pointer;
  padding: 0;
  color: #111;
  z-index: 10;
  opacity: 0.7;
  transition: opacity 0.2s;
}
.modal-close-btn:hover {
  opacity: 1;
  transform: scale(1.1);
  background-color: rgba(0,0,0,0.1);
}

/* Modal: Info */
#infoModal .modal-content {
  background: #1f1f1f;
  color: #fff;
  border-radius: 16px;
  max-width: 90%;
  width: 500px;
  max-height: 85vh;
  padding: 0; /* Usunięto padding z kontenera */
  display: flex !important;
  flex-direction: column;
  border: 1px solid rgba(255, 255, 255, 0.1);
  box-shadow: 0 8px 24px rgba(0,0,0,0.5);
}
#infoModal .modal-body {
  overflow-y: auto;
  padding: 20px; /* Padding przeniesiony tutaj */
  -webkit-overflow-scrolling: touch;
}

#infoModal .modal-body::-webkit-scrollbar {
    width: 6px;
}
#infoModal .modal-body::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.05);
}
#infoModal .modal-body::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.2);
    border-radius: 3px;
}
#infoModal .modal-body::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.3);
}

#infoModal h2 {
  margin-top: 0;
  padding-right: 40px;
  color: var(--accent-color);
  border-bottom: 1px solid rgba(255,255,255,0.15);
  padding-bottom: 10px;
  margin-bottom: 15px;
}
#infoModal h3 {
    margin-top: 20px;
    margin-bottom: 10px;
    color: #f0f0f0;
}
#infoModal p,
#infoModal li {
    color: #dcdcdc;
}
#infoModal .modal-close-btn {
  color: #fff;
  opacity: 0.7;
}
#infoModal .modal-close-btn:hover {
  opacity: 1;
  background-color: transparent;
  transform: none;
}

#infoModal ul {
    padding-left: 20px;
}

#infoModal li {
    margin-bottom: 8px;
}


/* ==========================================================================
           --- NOTIFICATION POPUP ---
           ========================================================================== */
.notification-popup {
  position: fixed;
  top: calc(var(--safe-area-top) + 10px);
  left: 50%;
  width: 350px;
  max-width: calc(100vw - 20px);
  background: rgba(30, 30, 30, 0.9);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 12px;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5);
  z-index: 10100;
  color: white;
  font-family:
    -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial,
    sans-serif;
  -webkit-backdrop-filter: blur(12px) saturate(120%);
  backdrop-filter: blur(12px) saturate(120%);
  opacity: 0;
  transform: translateX(-50%) scale(0.95);
  transition:
    opacity 0.2s ease-out,
    transform 0.2s ease-out,
    visibility 0.2s;
  visibility: hidden;
  pointer-events: none;
  display: flex;
  flex-direction: column;
}
.notification-popup.visible {
  opacity: 1;
  transform: translateX(-50%) scale(1);
  visibility: visible;
  pointer-events: auto;
}
.notification-header {
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 12px 16px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  font-weight: 600;
  font-size: 16px;
  flex-shrink: 0;
  position: relative;
}
.notification-header button {
  background: none;
  border: none;
  color: white;
  font-size: 24px;
  line-height: 1;
  padding: 0 4px;
  cursor: pointer;
  opacity: 0.7;
  transition: opacity 0.2s;
  position: absolute;
  right: 16px;
  top: 50%;
  transform: translateY(-50%);
}
.notification-header button:hover {
  opacity: 1;
}
.notification-list {
  list-style: none;
  margin: 0;
  padding: 8px;
  max-height: 80vh;
  overflow-y: auto;
  flex-grow: 1;
}
.notification-list::-webkit-scrollbar {
  width: 4px;
}
.notification-list::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.3);
  border-radius: 2px;
}

.notification-item {
  border-radius: 8px;
  cursor: pointer;
  transition: background-color 0.2s ease-out;
  margin-bottom: 4px;
}
.notification-item:hover {
  background-color: rgba(255, 255, 255, 0.08);
}
.notification-item.unread .notif-preview {
  font-weight: 600;
}

.notif-header {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px;
}

.notif-icon {
  width: 24px;
  height: 24px;
  flex-shrink: 0;
  color: rgba(255, 255, 255, 0.8);
}

.notif-content-wrapper {
  flex-grow: 1;
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 8px;
}

.notif-summary {
  display: flex;
  flex-direction: column;
}

.notif-preview {
  font-size: 14px;
  line-height: 1.3;
  color: rgba(255, 255, 255, 0.95);
}
.notif-time {
  font-size: 12px;
  color: rgba(255, 255, 255, 0.6);
}
.expand-chevron {
  width: 16px;
  height: 16px;
  flex-shrink: 0;
  align-self: center;
  transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  color: rgba(255, 255, 255, 0.6);
}
.notification-item.expanded .expand-chevron {
  transform: rotate(180deg);
}

.unread-dot {
  width: 8px;
  height: 8px;
  background-color: var(--accent-color);
  border-radius: 50%;
  flex-shrink: 0;
  align-self: center;
  transition:
    opacity 0.3s,
    transform 0.3s;
}

.notification-item:not(.unread) .unread-dot {
  opacity: 0;
  transform: scale(0);
}

.notif-full-details {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.35s ease-out;
}
.notification-item.expanded .notif-full-details {
  max-height: 200px;
}
.notif-full-details-content {
  padding: 0 12px 12px 48px;
  font-size: 14px;
  line-height: 1.5;
  color: rgba(255, 255, 255, 0.8);
  opacity: 0;
  transition: opacity 0.2s ease-in 0.15s;
}
.notification-item.expanded .notif-full-details-content {
  opacity: 1;
}

.notification-empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  padding: 40px 20px;
  text-align: center;
  color: rgba(255, 255, 255, 0.6);
}
.notification-empty-state svg {
  width: 48px;
  height: 48px;
  margin-bottom: 16px;
  opacity: 0.5;
}
.notification-empty-state p {
  font-size: 14px;
  font-weight: 500;
}
.notification-empty-state.hidden-by-js {
  display: none !important;
}

/* ==========================================================================
           --- NEW ACCOUNT PANEL STYLES ---
           ========================================================================== */
.account-modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100vh;
  background: transparent;
  z-index: 10200;
  opacity: 0;
  visibility: hidden;
  transition: visibility 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.account-modal-overlay.visible {
  opacity: 1;
  visibility: visible;
}

.account-modal-content {
  position: relative;
  width: 100%;
  height: 100vh;
  background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
  transform: translateX(-100%);
  transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  display: flex;
  flex-direction: column;
}

.account-modal-overlay.visible .account-modal-content {
  transform: translateX(0);
}

.account-modal-overlay.is-hiding .account-modal-content {
  transform: translateX(-100%);
}

.account-header {
  position: relative;
  height: var(--topbar-height);
  background: #1f1f1f;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0 20px; /* Simplified padding */
  padding-top: var(--safe-area-top);
  flex-shrink: 0;
}

.account-header h2 {
  font-size: 16px;
  font-weight: 600;
  color: #fff;
  margin: 0; /* FIX: Remove default margin for perfect centering */
}

.close-btn {
  position: absolute;
  right: 10px;
  top: var(--safe-area-top);
  height: var(
    --topbar-base-height
  ); /* FIX: Set height to match visible header area */
  width: 40px;
  background: none;
  border: none;
  color: #fff;
  font-size: 24px;
  font-weight: 400;
  line-height: 1;
  cursor: pointer;
  display: flex;
  align-items: center; /* FIX: Vertical centering */
  justify-content: center; /* FIX: Horizontal centering */
  transition: all 0.2s ease;
  z-index: 10;
}

.close-btn:hover {
  opacity: 0.8;
}

.close-btn:active {
  transform: scale(0.9);
}

.account-tabs {
  display: flex;
  background: rgba(255, 255, 255, 0.03);
  border-bottom: 1px solid rgba(255, 255, 255, 0.08);
  margin: 0;
  padding: 0;
  flex-shrink: 0;
}

.tab-btn {
  flex: 1;
  padding: 14px 8px;
  background: rgba(255, 255, 255, 0.08);
  border: none;
  border-left: 1px solid rgba(255, 255, 255, 0.1);
  border-bottom: 2px solid transparent;
  color: #fff;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  position: relative;
  transition: all 0.3s ease;
  border-radius: 0;
}

.tab-btn:hover {
  color: rgba(255, 255, 255, 0.9);
  background: rgba(255, 255, 255, 0.05);
}

.tab-btn.active {
  color: rgba(255, 255, 255, 0.6);
  background: none;
  border-bottom-color: var(--accent-color);
}

.tab-btn:last-child {
  border-right: 1px solid rgba(255, 255, 255, 0.1);
}

.account-content {
  flex: 1;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  padding-bottom: calc(80px + var(--safe-area-bottom)); /* ZWIĘKSZONO PADDING: Zapewnia więcej miejsca na dole */
  position: relative; /* Niezbędne dla kontekstu pozycjonowania potomnych elementów */
}

.account-content::-webkit-scrollbar {
  display: none;
}

.tab-pane {
  display: none;
  padding: 20px 16px;
}
.tab-pane > *:last-child {
  margin-bottom: 0;
}

.tab-pane.active {
  display: block;
}

.profile-section,
.avatar-section,
.form-section,
.settings-section {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 16px;
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.section-title {
  font-size: 18px;
  font-weight: 700;
  color: #fff;
  margin-bottom: 20px;
  display: flex;
  align-items: center;
  gap: 12px;
}

.section-title::before {
  content: "";
  width: 4px;
  height: 18px;
  background: linear-gradient(180deg, #ff0055, #ff4081);
  border-radius: 2px;
}

.avatar-section {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
  text-align: center;
  position: relative;
}

.avatar-wrapper {
  position: relative;
  width: 80px;
  height: 80px;
  flex-shrink: 0;
}

.avatar-container {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  overflow: hidden;
  border: 2px solid rgba(255, 255, 255, 0.8);
  box-shadow: 0 0 15px rgba(255, 0, 85, 0.3);
}

.avatar-img {
  width: 100%;
  height: 100%;
  display: block;
  object-fit: cover;
  transition: all 0.2s;
}

.avatar-edit-btn {
  position: absolute;
  bottom: -12px;
  left: 50%;
  transform: translateX(-50%);
  width: 28px;
  height: 28px;
  background: var(--accent-color, #ff0055);
  border: 2px solid #2d2d2d;
  border-radius: 50%;
  color: white;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  font-weight: bold;
  line-height: 1;
  z-index: 2;
}

.avatar-edit-btn:hover {
  transform: translateX(-50%) scale(1.1);
}

.avatar-info {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
}

.avatar-name {
  font-size: 18px;
  font-weight: 700;
  color: #fff;
  margin: 0;
}

.avatar-email {
  font-size: 13px;
  color: rgba(255, 255, 255, 0.6);
  margin: 0;
  margin-bottom: 6px;
}

.user-badge {
  display: flex;
  align-items: center;
  gap: 6px;
  background: linear-gradient(135deg, #ffd700, #ffb347);
  color: #2d1b00;
  padding: 4px 12px;
  border-radius: 12px;
  font-size: 12px;
  font-weight: 600;
  box-shadow: 0 2px 8px rgba(255, 215, 0, 0.3);
}

.badge-icon {
  width: 14px;
  height: 14px;
}

.toggle-container {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 20px;
}

.toggle-label {
  font-size: 14px;
  color: white;
  margin: 0;
}

.toggle-switch {
  position: relative;
  width: 50px;
  height: 24px;
  background: rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  cursor: pointer;
  transition: background-color 0.3s ease;
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.toggle-switch.active {
  background: linear-gradient(135deg, #ff0055, #ff4081);
  border-color: #ff0055;
}

.toggle-slider {
  position: absolute;
  top: 1px;
  left: 1px;
  width: 22px;
  height: 22px;
  background: #fff;
  border-radius: 50%;
  transition: transform 0.3s ease;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

.toggle-switch.active .toggle-slider {
  transform: translateX(26px);
}

.language-selector {
  display: flex;
  gap: 8px;
}

.language-option {
  flex: 1;
  padding: 12px 16px;
  background: rgba(255, 255, 255, 0.08);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 8px;
  color: rgba(255, 255, 255, 0.7);
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.3s ease;
  text-align: center;
}

.language-option:hover {
  background: rgba(255, 255, 255, 0.12);
  color: rgba(255, 255, 255, 0.9);
  border-color: rgba(255, 255, 255, 0.3);
}

.language-option.active {
  background: linear-gradient(135deg, #ff0055, #ff4081);
  border-color: #ff0055;
  color: #fff;
  transform: scale(1.02);
}

.form-group {
  margin-bottom: 18px; /* FIX: Adjusted spacing */
}

.form-row {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 16px;
}

.form-label {
  display: block;
  font-size: 14px;
  font-weight: 500;
  color: white;
  margin-bottom: 8px; /* FIX: Adjusted spacing */
}

.form-input {
  width: 100%;
  padding: 12px 16px;
  background: rgba(255, 255, 255, 0.08);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 12px;
  color: #fff;
  font-size: 16px;
  transition: all 0.3s ease;
}

.form-input:focus {
  outline: none;
  border-color: #ff0055;
  background: rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 0 3px rgba(255, 0, 85, 0.1);
}

.form-input::placeholder {
  color: rgba(255, 255, 255, 0.5);
}
.form-section .form-group:last-of-type,
.settings-section .form-group:last-of-type,
#password-tab .form-group:last-of-type,
#delete-tab .form-group:last-of-type {
  margin-bottom: 0;
}

.btn-primary {
  background: linear-gradient(135deg, #ff0055, #ff4081);
  border: 1px solid rgba(255, 255, 255, 0.8);
  padding: 14px 24px;
  border-radius: 12px;
  color: #fff;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  width: 100%;
  margin-top: 8px;
}

.btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 20px rgba(255, 0, 85, 0.3);
}

.btn-primary:active {
  transform: translateY(0);
}

.btn-primary:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
  box-shadow: none;
}

.btn-danger {
  background: linear-gradient(135deg, #dc2626, #ef4444);
  border: 1px solid rgba(255, 255, 255, 0.8);
  padding: 14px 24px;
  border-radius: 12px;
  color: #fff;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  width: 100%;
  margin-top: 8px;
}

.btn-danger:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 20px rgba(220, 38, 38, 0.3);
}

.status-message {
  padding: 12px 16px;
  border-radius: 8px;
  margin-top: 16px;
  font-size: 14px;
  font-weight: 500;
  display: none;
  opacity: 0;
  transform: translateY(-10px);
  transition: all 0.3s ease;
}

.status-message.show {
  display: block;
  opacity: 1;
  transform: translateY(0);
}

.status-success {
  background: rgba(34, 197, 94, 0.15);
  border: 1px solid rgba(34, 197, 94, 0.3);
  color: #22c55e;
}

.status-error {
  background: rgba(239, 68, 68, 0.15);
  border: 1px solid rgba(239, 68, 68, 0.3);
  color: #ef4444;
}

.helper-text {
  font-size: 12px;
  color: rgba(255, 255, 255, 0.5);
  margin-top: 8px;
  line-height: 1.4;
}

.crop-modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100vh;
  background: rgba(0, 0, 0, 0.95);
  z-index: 3000;
  display: none;
  align-items: center;
  justify-content: center;
  padding: 20px;
}

.crop-modal.visible {
  display: flex;
}

.crop-modal-content {
  background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
  border-radius: 16px;
  width: 100%;
  max-width: 400px;
  display: flex;
  flex-direction: column;
  border: 1px solid rgba(255, 255, 255, 0.1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.7);
  animation: premiumEntrance 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.crop-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 16px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.crop-header h3 {
  font-size: 16px;
  font-weight: 600;
  margin: 0;
}

.crop-header .close-btn {
  font-size: 24px;
  font-weight: 400;
  color: #fff;
  opacity: 0.7;
}

.crop-body {
  padding: 20px;
  display: flex;
  justify-content: center;
  align-items: center;
}

.crop-canvas-container {
  position: relative;
  width: 300px;
  height: 300px;
  max-width: 100%;
  border-radius: 50%;
  overflow: hidden;
  cursor: grab;
}

.crop-canvas-container:active {
  cursor: grabbing;
}

#cropCanvas {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

.crop-overlay-circle {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border-radius: 50%;
  box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.7);
  pointer-events: none;
  border: 2px dashed rgba(255, 255, 255, 0.7);
}

.crop-footer {
  padding: 16px;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.zoom-controls {
  display: flex;
  align-items: center;
  gap: 12px;
}

.zoom-btn {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: #fff;
  width: 32px;
  height: 32px;
  border-radius: 50%;
  font-size: 20px;
  cursor: pointer;
  transition: background-color 0.2s;
}

.zoom-btn:hover {
  background: rgba(255, 255, 255, 0.2);
}

.zoom-slider {
  flex: 1;
  -webkit-appearance: none;
  appearance: none;
  width: 100%;
  height: 4px;
  background: rgba(255, 255, 255, 0.2);
  border-radius: 2px;
  outline: none;
}

.zoom-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 18px;
  height: 18px;
  background: #fff;
  cursor: pointer;
  border-radius: 50%;
  border: 2px solid var(--accent-color);
}

.zoom-slider::-moz-range-thumb {
  width: 18px;
  height: 18px;
  background: #fff;
  cursor: pointer;
  border-radius: 50%;
  border: 2px solid var(--accent-color);
}

#cropSaveBtn {
  margin-top: 0;
}

.file-input {
  display: none;
}

.loading-spinner {
  display: inline-block;
  width: 16px;
  height: 16px;
  border: 2px solid rgba(255, 255, 255, 0.3);
  border-radius: 50%;
  border-top-color: #fff;
  animation: spin 1s ease-in-out infinite;
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

@media (max-width: 480px) {
  .tab-pane {
    padding: 16px;
  }
  .profile-section,
  .avatar-section,
  .form-section,
  .settings-section {
    padding: 16px;
  }
}

/* ==========================================================================
           --- STYLE POMOCNICZE I DOSTĘPNOŚĆ ---
           ========================================================================== */
.tiktok-symulacja .hidden-by-js {
  display: none !important;
}
#bmc-wbtn {
  /* Ukryj domyślny przycisk BuyMeACoffee */
  display: none !important;
  opacity: 0 !important;
  pointer-events: none !important;
}
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.001ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.001ms !important;
  }
}
.tiktok-symulacja .icon-button:focus-visible,
.tiktok-symulacja .profileButton:focus-visible,
.tiktok-symulacja .logged-in-menu a:focus-visible {
  outline: 2px solid white;
  outline-offset: 2px;
}

#app-frame {
  position: relative; /* Make this the positioning context */
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  overflow: hidden; /* Prevent modals from overflowing */
  z-index: 2000;
}


/* PWA Prompt Styles from Reference */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.001ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.001ms !important;
  }
}
.pwa-prompt {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  background: #333;
  color: white;
  z-index: 10000;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 1rem;
  padding-bottom: calc(1rem + var(--safe-area-bottom));
  box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.3);
  transform: translateY(100%);
  transition: transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  visibility: hidden;
  height: var(--bottombar-height);
}
.pwa-prompt.visible {
  transform: translateY(0);
  visibility: visible;
}
.pwa-prompt-content {
  display: flex;
  flex-direction: column;
}
.pwa-prompt-title {
  font-weight: bold;
  font-size: 1.1rem;
  margin: 0 0 0.25rem 0;
}
.pwa-prompt-description {
  font-size: 0.9rem;
  margin: 0;
  opacity: 0.8;
}
.pwa-prompt-button {
  background-color: var(--accent-color);
  color: white;
  border: none;
  padding: 0.75rem 1.5rem;
  border-radius: 8px;
  font-weight: bold;
  cursor: pointer;
  flex-shrink: 0;
  margin-left: 1rem;
  position: relative; /* Create a new stacking context */
  z-index: 1; /* Ensure it's above other content in the same flex container */
  pointer-events: auto !important; /* Force clickability */
}
.pwa-prompt-ios {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  background: rgba(20, 20, 20, 0.9);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  color: white;
  z-index: 10001;
  padding: 1rem;
  padding-bottom: calc(1rem + var(--safe-area-bottom));
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  transform: translateY(100%);
  transition:
    transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94),
    visibility 0.5s;
  visibility: hidden;
}
.pwa-prompt-ios.visible {
  transform: translateY(0);
  visibility: visible;
}
.pwa-ios-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
  font-weight: bold;
  font-size: 1.2rem;
}
.pwa-ios-close-button {
  background: none;
  border: none;
  color: white;
  font-size: 1.5rem;
  cursor: pointer;
  opacity: 0.7;
}
.pwa-ios-body {
  font-size: 1rem;
  line-height: 1.5;
}
.pwa-ios-body p {
  margin-bottom: 0.75rem;
}

/* --- Desktop PWA Modal --- */
#pwa-desktop-modal {
  z-index: 10004;
}
#pwa-desktop-modal .modal-content {
  background: white;
  color: #111;
  border-radius: 12px;
  max-width: 90%;
  width: 450px;
  padding: 20px;
  text-align: center;
}

#pwa-desktop-modal h2 {
  margin-top: 0;
  padding-right: 40px; /* Space for the close button */
  font-size: 1.4rem;
  margin-bottom: 1rem;
}

#pwa-desktop-modal .modal-body p {
  line-height: 1.5;
  font-size: 1rem;
  color: #333;
}

#pwa-desktop-modal .modal-close-btn {
  color: #111;
}

/* --- Video Error Overlay --- */
.error-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.6);
  -webkit-backdrop-filter: blur(8px);
  backdrop-filter: blur(8px);
  z-index: 102; /* Above pause, below sidebar */
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  text-align: center;
  padding: 20px;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease;
}

.error-overlay .error-icon {
  width: 64px;
  height: 64px;
  margin-bottom: 24px;
  color: #ffc107; /* A warning yellow */
  filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.4));
}

.error-overlay .error-title {
  font-size: 22px;
  font-weight: 700;
  color: #fff;
  margin-bottom: 4px;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
}

.error-overlay .error-subtitle {
  font-size: 16px;
  color: rgba(255, 255, 255, 0.8);
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
  margin-bottom: 24px;
}

.error-overlay .error-retry-button {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  padding: 12px 24px;
  font-size: 16px;
  font-weight: 600;
  border-radius: 24px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.error-overlay .error-retry-button:hover {
  background: rgba(255, 255, 255, 0.2);
  border-color: rgba(255, 255, 255, 0.5);
}

.error-overlay .error-retry-button:active {
  transform: scale(0.95);
}

/* Styles for installed PWA bar */

.force-hide {
  display: none !important;
}

/* ==========================================================================
   --- TIKTOK PUBLIC PROFILE MODAL ---
   ========================================================================== */
#tiktok-profile-modal {
  /* This modal requires a special override. It must be `fixed` to slide over
     the #app-frame, which has `overflow: hidden`. On desktop, we revert this
     to `absolute` to keep it constrained. */
  position: fixed;
}

#tiktok-profile-modal .tiktok-profile-content {
  background-color: #2d2d2d;
  color: #fff;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  transform: translateX(100%);
  transition: transform 0.4s ease-in-out;
  font-family:
    -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial,
    sans-serif;
}

#tiktok-profile-modal.visible .tiktok-profile-content {
  transform: translateX(0);
}

#tiktok-profile-modal.is-hiding .tiktok-profile-content {
  transform: translateX(100%);
}

.tiktok-profile-header {
  height: var(--topbar-height);
  display: grid;
  grid-template-columns: 60px 1fr 60px;
  align-items: center;
  padding: 0;
  padding-top: var(--safe-area-top);
  background-color: #1f1f1f;
  border-bottom: 1px solid rgba(255, 255, 255, 0.15);
  flex-shrink: 0;
}

.tiktok-profile-header .username {
  font-size: 16px;
  font-weight: 700;
  text-align: center;
  grid-column: 2;
}

.tiktok-profile-header .profile-action-btn,
#tiktok-profile-modal .modal-close-btn {
  background: none;
  border: none;
  color: #fff;
  cursor: pointer;
  padding: 0;
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition:
    transform 0.1s ease-in-out,
    opacity 0.2s;
}

.tiktok-profile-header .profile-action-btn:active,
#tiktok-profile-modal .modal-close-btn:active {
  transform: scale(0.9);
}

#tiktok-profile-modal .modal-close-btn {
  position: static;
  color: #fff;
  font-size: 28px;
}

.profile-main {
  flex-grow: 1;
  overflow-y: auto;
  padding: 20px 16px;
}

.profile-main::-webkit-scrollbar {
  display: none;
}

.profile-summary {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
  margin-bottom: 16px;
}

.profile-avatar-wrapper {
  flex-shrink: 0;
}

.profile-avatar {
  width: 90px;
  height: 90px;
  border-radius: 50%;
  object-fit: cover;
  border: 2px solid rgba(255, 255, 255, 0.1);
}

.profile-stats {
  display: flex;
  justify-content: space-around;
  flex-grow: 1;
  gap: 20px;
}

.stat-item {
  text-align: center;
}

.stat-number {
  font-size: 18px;
  font-weight: 700;
  display: block;
}

.stat-label {
  font-size: 14px;
  color: rgba(255, 255, 255, 0.6);
}

.profile-nickname {
  font-size: 20px;
  font-weight: 700;
  margin-bottom: 4px;
}

#tiktok-profile-at-username {
  font-size: 14px;
  color: rgba(255, 255, 255, 0.6);
  margin-top: -8px;
}

.profile-bio {
  font-size: 14px;
  line-height: 1.5;
  color: rgba(255, 255, 255, 0.8);
  margin-bottom: 16px;
  white-space: pre-wrap;
}

.profile-actions {
  display: flex;
  gap: 8px;
  margin-bottom: 20px;
}

.profile-actions .follow-button {
  flex-grow: 1;
  background-color: var(--accent-color);
  color: #fff;
  border: none;
  border-radius: 4px;
  padding: 12px;
  font-weight: 600;
  font-size: 16px;
  cursor: pointer;
}

.profile-actions .icon-button {
  padding: 10px;
  background-color: rgba(255, 255, 255, 0.1);
  border-radius: 4px;
  border: 1px solid rgba(255, 255, 255, 0.2);
}
.profile-actions .icon-button svg {
  width: 24px;
  height: 24px;
  fill: #fff;
}

.profile-tabs {
  display: flex;
  border-bottom: 1px solid rgba(255, 255, 255, 0.2);
  gap: 2px;
}

.profile-tabs .tab {
  flex: 1;
  padding: 14px;
  text-align: center;
  cursor: pointer;
  position: relative;
  color: rgba(255, 255, 255, 0.8);
  background-color: #1f1f1f;
  border-radius: 4px 4px 0 0;
  transition: background-color 0.2s ease;
}

.profile-tabs .tab:hover {
  background-color: #2a2a2a;
}

.profile-tabs .tab.active {
  color: #fff;
  background-color: #3a3a3a;
}

.profile-tabs .tab.active::after {
  content: "";
  position: absolute;
  bottom: -1px;
  left: 0;
  width: 100%;
  height: 2px;
  background-color: var(--accent-color);
}

.profile-tabs .tab svg {
  width: 28px;
  height: 28px;
  fill: currentColor;
}

.video-gallery {
  display: none;
  grid-template-columns: repeat(3, 1fr);
  gap: 2px;
  padding-top: 2px;
}

.video-gallery.active {
  display: grid;
}

.video-thumbnail {
  position: relative;
  padding-bottom: 140%;
  background-color: #333;
  border-radius: 2px;
  overflow: hidden;
}

.video-thumbnail img {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.video-views {
  position: absolute;
  bottom: 8px;
  left: 8px;
  color: var(--white);
  font-size: 13px;
  font-weight: 600;
  display: flex;
  align-items: center;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
}

.video-views svg {
  width: 16px;
  height: 16px;
  margin-right: 4px;
  fill: white;
}

/* --- Toast Notification --- */
/* (This style is now handled by #alertBox for consistency) */

/* ============================================================================
   WELCOME MODAL STYLES - Premium Design
   ============================================================================ */

/* Overlay z mocnym blur */
.welcome-modal {
  background: rgba(0, 0, 0, 0.85);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  z-index: 10010;
}

/* Content - premium card */
.welcome-modal-content {
  background: linear-gradient(165deg, #2a2a2a 0%, #1a1a1a 100%);
  border-radius: 28px;
  padding: 0;
  width: 92%;
  max-width: 460px;
  text-align: center;
  border: 2px solid rgba(255, 0, 85, 0.3);
  box-shadow:
    0 32px 80px rgba(0, 0, 0, 0.9),
    0 0 80px rgba(255, 0, 85, 0.2),
    inset 0 1px 0 rgba(255, 255, 255, 0.05);
  overflow: hidden;
  position: relative;
}

/* Ambient glow effect */
.welcome-modal-content::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(
    circle at center,
    rgba(255, 0, 85, 0.08) 0%,
    transparent 60%
  );
  animation: ambientPulse 4s ease-in-out infinite;
  pointer-events: none;
}

@keyframes ambientPulse {
  0%, 100% { opacity: 0.3; transform: scale(1); }
  50% { opacity: 0.6; transform: scale(1.1); }
}

/* Ikona na górze z zaawansowanym gradientem */
.welcome-icon-wrapper {
  background: linear-gradient(135deg, #ff0055 0%, #ff4081 50%, #ff0055 100%);
  background-size: 200% 200%;
  padding: 40px;
  margin: 0;
  position: relative;
  overflow: hidden;
  animation: gradientShift 8s ease infinite;
}

@keyframes gradientShift {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

.welcome-icon-wrapper::before {
  content: '';
  position: absolute;
  top: -60%;
  left: -60%;
  width: 220%;
  height: 220%;
  background: radial-gradient(
    circle,
    rgba(255, 255, 255, 0.15) 0%,
    transparent 60%
  );
  animation: shimmer 4s ease-in-out infinite;
}

@keyframes shimmer {
  0%, 100% { transform: translate(0, 0) scale(1); }
  50% { transform: translate(15%, 15%) scale(1.05); }
}

.welcome-icon {
  width: 72px;
  height: 72px;
  color: #fff;
  filter: drop-shadow(0 6px 20px rgba(0, 0, 0, 0.5));
  position: relative;
  z-index: 1;
  animation: iconFloat 3s ease-in-out infinite;
}

@keyframes iconFloat {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-8px); }
}

/* Signature line (dekoracja) */
.welcome-signature {
  margin-top: 24px;
  padding-top: 20px;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  position: relative;
}

.signature-line {
  width: 60px;
  height: 2px;
  background: linear-gradient(90deg, transparent, #ff0055, transparent);
  margin: 0 auto 16px;
  border-radius: 1px;
  box-shadow: 0 0 15px rgba(255, 0, 85, 0.5);
}

/* Tytuł z efektem świecenia */
.welcome-title {
  font-size: 32px;
  font-weight: 900;
  color: #fff;
  margin: 28px 24px 12px;
  line-height: 1.1;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  text-shadow:
    0 0 20px rgba(255, 0, 85, 0.5),
    0 4px 12px rgba(0, 0, 0, 0.7);
  position: relative;
  z-index: 1;
}

.welcome-title-main {
  animation: titleGlow 2s ease-in-out infinite;
}

@keyframes titleGlow {
  0%, 100% { text-shadow: 0 0 20px rgba(255, 0, 85, 0.4); }
  50% { text-shadow: 0 0 30px rgba(255, 0, 85, 0.7); }
}

.welcome-title-emoji {
  font-size: 36px;
  animation: sparkle 2.5s ease-in-out infinite;
  display: inline-block;
}

@keyframes sparkle {
  0%, 100% { transform: scale(1) rotate(0deg); }
  25% { transform: scale(1.15) rotate(-15deg); }
  75% { transform: scale(1.15) rotate(15deg); }
}

/* Body z efektem glassmorphism */
.welcome-body {
  padding: 0 28px 36px;
  position: relative;
  z-index: 1;
}

/* Hero text z premium typografią */
.welcome-text-hero {
  font-size: 24px;
  font-weight: 800;
  color: #fff;
  margin: 0 0 24px;
  line-height: 1.3;
  text-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
  letter-spacing: -0.5px;
}

/* Divider z animacją */
.welcome-divider {
  width: 80px;
  height: 4px;
  background: linear-gradient(90deg, transparent, #ff0055, #ff4081, transparent);
  background-size: 200% 100%;
  margin: 0 auto 28px;
  border-radius: 2px;
  box-shadow: 0 0 20px rgba(255, 0, 85, 0.6);
  animation: dividerFlow 3s ease-in-out infinite;
}

@keyframes dividerFlow {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

/* Highlight text z premium efektami */
.welcome-text-highlight {
  font-size: 28px;
  font-weight: 900;
  background: linear-gradient(135deg, #fff 0%, #ff0055 50%, #ff4081 100%);
  background-size: 200% 200%;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin: 0 0 16px;
  letter-spacing: 0.5px;
  animation: textShimmer 4s ease infinite;
  text-shadow: 0 0 30px rgba(255, 0, 85, 0.8);
}

@keyframes textShimmer {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

/* Description z lepszą czytelnością */
.welcome-text-description {
  font-size: 17px;
  color: rgba(255, 255, 255, 0.95);
  margin: 0 0 36px;
  line-height: 1.6;
  font-weight: 500;
  text-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
}

/* Premium buttons */
.welcome-actions {
  display: flex;
  flex-direction: column;
  gap: 14px;
  margin-bottom: 24px;
}

.welcome-btn {
  padding: 18px 28px;
  border-radius: 16px;
  font-size: 17px;
  font-weight: 800;
  cursor: pointer;
  transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  position: relative;
  overflow: hidden;
  letter-spacing: 0.5px;
  text-transform: uppercase;
}

/* Ripple effect */
.welcome-btn::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.3);
  transform: translate(-50%, -50%);
  transition: width 0.8s ease-out, height 0.8s ease-out;
}

.welcome-btn:active::before {
  width: 400px;
  height: 400px;
}

.welcome-btn svg {
  width: 22px;
  height: 22px;
  position: relative;
  z-index: 1;
  filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
}

.welcome-btn span {
  position: relative;
  z-index: 1;
}

/* Primary button - premium gradient */
.welcome-btn-primary {
  background: linear-gradient(135deg, #ff0055 0%, #ff4081 50%, #ff0055 100%);
  background-size: 200% 200%;
  color: #fff;
  box-shadow:
    0 12px 32px rgba(255, 0, 85, 0.5),
    0 0 40px rgba(255, 0, 85, 0.3),
    inset 0 1px 0 rgba(255, 255, 255, 0.2);
  animation: primaryGradient 3s ease infinite;
}

@keyframes primaryGradient {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

.welcome-btn-primary:hover {
  transform: translateY(-4px) scale(1.02);
  box-shadow:
    0 16px 48px rgba(255, 0, 85, 0.6),
    0 0 60px rgba(255, 0, 85, 0.4),
    inset 0 1px 0 rgba(255, 255, 255, 0.3);
}

.welcome-btn-primary:active {
  transform: translateY(-2px) scale(0.98);
}

/* Secondary button - glassmorphism */
.welcome-btn-secondary {
  background: rgba(255, 255, 255, 0.08);
  color: rgba(255, 255, 255, 0.95);
  border: 2px solid rgba(255, 255, 255, 0.25);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  box-shadow:
    0 8px 24px rgba(0, 0, 0, 0.3),
    inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

.welcome-btn-secondary:hover {
  background: rgba(255, 255, 255, 0.15);
  border-color: rgba(255, 255, 255, 0.4);
  transform: translateY(-3px) scale(1.01);
  box-shadow:
    0 12px 32px rgba(0, 0, 0, 0.4),
    inset 0 1px 0 rgba(255, 255, 255, 0.2);
}

.welcome-btn-secondary:active {
  transform: translateY(-1px) scale(0.98);
}

/* Footer text z lepszym kontrastem */
.welcome-footer-text {
  font-size: 15px;
  color: rgba(255, 255, 255, 0.7);
  margin: 0;
  line-height: 1.6;
  letter-spacing: 0.3px;
  text-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
}

.welcome-footer-text strong {
  color: #ff0055;
  font-weight: 800;
}

/* Responsive refinements */
@media (max-width: 480px) {
  .welcome-modal-content {
    width: 96%;
    border-radius: 24px;
    border-width: 1.5px;
  }

  .welcome-icon-wrapper {
    padding: 32px;
  }

  .welcome-icon {
    width: 56px;
    height: 56px;
  }

  .welcome-title {
    font-size: 26px;
    margin: 24px 20px 10px;
  }

  .welcome-title-emoji {
    font-size: 28px;
  }

  .welcome-body {
    padding: 0 20px 32px;
  }

  .welcome-text-hero {
    font-size: 20px;
  }

  .welcome-text-highlight {
    font-size: 24px;
  }

  .welcome-text-description {
    font-size: 15px;
  }

  .welcome-btn {
    padding: 16px 24px;
    font-size: 15px;
  }

  .welcome-footer-text {
    font-size: 13px;
  }
}

/* Ultra-smooth entrance animation */
.welcome-modal.visible .welcome-modal-content {
  animation: premiumEntrance 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

@keyframes premiumEntrance {
  0% {
    opacity: 0;
    transform: translateY(50px) scale(0.9) rotateX(-10deg);
  }
  60% {
    opacity: 1;
    transform: translateY(-10px) scale(1.02) rotateX(2deg);
  }
  100% {
    opacity: 1;
    transform: translateY(0) scale(1) rotateX(0);
  }
}


/* Animacja pojawiania się overlay */
@keyframes errorFadeIn {
  from {
    opacity: 0;
    transform: scale(0.9);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

/* --- Underline Styles --- */
.secret-subtitle u,
.pwa-secret-subtitle u,
.pwa-prompt-description u {
  text-decoration: none;
  border-bottom-width: 2px;
  border-bottom-style: solid;
  padding-bottom: 1px;
  cursor: pointer;
}

/* Color for 'Log in' and 'Download' in the secret overlay */
.secret-subtitle u,
.pwa-secret-subtitle u {
  border-bottom-color: #fff; /* White */
}

/* Color for 'Download the app' (in all locations) */
.pwa-prompt-description u[data-translate-key="installPwaSubheadingAction"] {
  border-bottom: none !important;
  text-decoration: none !important;
}

.form-row {
  display: flex;
  gap: 16px;
  flex-wrap: wrap;
}

.form-row .form-group {
  flex: 1;
  min-width: calc(50% - 8px);
}

/* --- FIX: Poprawki układu formularza --- */
#profile-tab #profileForm,
#profile-tab .form-row {
  display: flex;
  flex-direction: column;
  gap: 16px; /* Spójny odstęp między wszystkimi polami */
}

#profile-tab .form-group {
    margin-bottom: 0; /* Usuwamy stary margines, polegamy na 'gap' */
}

#profile-tab .form-label {
    margin-bottom: 8px; /* Dodajemy mały odstęp między etykietą a polem input */
}

/* ============================================================================
   DESKTOP - Zwężenie do proporcji 9:16 (jak telefon)
   ============================================================================ */

@media (min-width: 600px) {
  /* Główny kontener aplikacji */
  #webyx-container {
    height: 100vh;
    width: calc(100vh * 9 / 16); /* Proporcje 9:16 */
    max-width: 100%;
    margin: 0 auto; /* Wyśrodkowanie */
    left: 0; /* POPRAWKA: Niezbędne do centrowania elementu fixed/absolute */
    right: 0; /* POPRAWKA: Niezbędne do centrowania elementu fixed/absolute */
    border-left: 1px solid #333;
    border-right: 1px solid #333;
    /* ZMIEŃ: Użyj intensywnego cienia z akcentem kolorystycznym */
    box-shadow: 0 0 80px rgba(0, 0, 0, 0.9), 0 0 40px rgba(255, 0, 85, 0.25);
    overflow: hidden;
  }

  /* App frame - jeśli używasz */
  #app-frame {
    width: calc(100vh * 9 / 16);
    max-width: 100%;
    margin: 0 auto;
    left: 0; /* POPRAWKA: Niezbędne do centrowania elementu fixed/absolute */
    right: 0; /* POPRAWKA: Niezbędne do centrowania elementu fixed/absolute */
  }

  /* [FIX] Centrowanie i ograniczanie szerokości paska PWA na desktopie */
  .pwa-prompt,
  .pwa-prompt-ios {
    width: calc(100vh * 9 / 16);
    max-width: 100%;
    left: 0;
    right: 0;
    margin: 0 auto;
    border-left: 1px solid #333;
    border-right: 1px solid #333;
  }

  /* NOWE: Ujednolicony selektor modali i widgetów */

  #commentsModal,
  .modal-overlay,
  .fl-modal-overlay,
  .crop-modal,
  .notification-popup,
  .image-lightbox,
  #bmc-w-modal-container,
  .account-modal-overlay,
  #tiktok-profile-modal,
  #bmc-w-modal-container iframe,
  #bmc-w-modal-container > div
  {
    width: calc(100vh * 9 / 16) !important;
    max-width: 100% !important;
    left: 0 !important;
    right: 0 !important;
    margin: 0 auto !important;
    top: 0 !important;
    height: 100% !important;
    border-left: 1px solid var(--border-color) !important;
    border-right: 1px solid var(--border-color) !important;
    box-sizing: border-box !important;
  }

  /* NOWE: Wymuszenie dopasowania wewnętrznej zawartości modali do nowej szerokości */
  .modal-overlay#tiktok-profile-modal {
    position: absolute !important;
  }
  .modal-overlay .modal-content,
  .fl-modal-overlay .fl-modal-content,
  .crop-modal .crop-modal-content,
  .notification-popup,
  .account-modal-content,
  .tiktok-profile-content
  {
    width: 100% !important;
    max-width: 100% !important;
    box-sizing: border-box !important;
    left: 0 !important;
    right: 0 !important;
    margin: 0 !important;
    top: 0 !important;
  }

  /* Poprawka dla popupu powiadomień, aby nie miał podwójnego obramowania */
  .notification-popup {
      border: 1px solid rgba(255, 255, 255, 0.15) !important;
  }

  /* ZMIEŃ: Uproszczenie tła body do ciemnej czerni */
  body {
    background: #0a0a0a !important;
    overflow-x: hidden;
  }

  /* NOWA REGULA: Ambient Glow */
  /* Ambient Glow - duży, rozmyty gradient w kolorze akcentu */
  body::after {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: radial-gradient(
      circle at center,
      rgba(255, 0, 85, 0.12) 0%, /* Jaśniejszy punkt w centrum */
      rgba(255, 0, 85, 0.05) 30%, /* Większy zasięg */
      transparent 65%
    );
    opacity: 0.9;
    z-index: -1;
    pointer-events: none;
    animation: subtleShimmer 8s ease-in-out infinite;
  }

  @keyframes subtleShimmer {
    0%, 100% { transform: scale(1); opacity: 0.9; }
    50% { transform: scale(1.1); opacity: 1; }
  }
}

/* ============================================================================
   TABLET - Dla tabletów (600px - 1024px)
   ============================================================================ */

@media (min-width: 600px) and (max-width: 1024px) {
  #webyx-container {
    border-left: 1px solid #444;
    border-right: 1px solid #444;
  }
}

/* ============================================================================
   DESKTOP - Dla dużych ekranów (>1024px)
   ============================================================================ */

@media (min-width: 1024px) {
  #webyx-container {
    border-left: 2px solid #555;
    border-right: 2px solid #555;
    box-shadow: 0 0 80px rgba(0, 0, 0, 0.8);
  }
}

/* ============================================================================
   OPCJONALNIE - Gradient background za aplikacją
   ============================================================================ */

/* NOWA REGULA: Ambient Glow */
@media (min-width: 600px) {
  /* Ambient Glow - duży, rozmyty gradient w kolorze akcentu */
  body::after {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: radial-gradient(
      circle at center,
      rgba(255, 0, 85, 0.07) 0%, /* Jasny punkt w centrum */
      rgba(255, 0, 85, 0.03) 25%,
      transparent 70%
    );
    opacity: 0.8;
    z-index: -1;
    pointer-events: none;
    animation: subtleShimmer 10s ease-in-out infinite;
  }

  @keyframes subtleShimmer {
    0%, 100% { transform: scale(1); opacity: 0.8; }
    50% { transform: scale(1.05); opacity: 0.9; }
  }
}

/* WZMOCNIONE ukrywanie w trybie standalone */
@media (display-mode: standalone) {
  .pwa-prompt,
  .pwa-prompt-ios {
    display: none;
    visibility: hidden;
    opacity: 0;
    pointer-events: none;
    height: 0;
    overflow: hidden;
  }

  /* ✅ FIX: Gwarantuje pełną wysokość w trybie PWA */
  #app-frame {
    height: 100% !important;
  }
}

/* DODAJ TAKŻE dla iOS */
@media (display-mode: fullscreen) {
  .pwa-prompt,
  .pwa-prompt-ios {
    display: none;
    visibility: hidden;
    opacity: 0;
    pointer-events: none;
    height: 0;
    overflow: hidden;
  }
}

/* Ukryj pasek PWA gdy standalone na iOS */
@media (display-mode: standalone) and (-webkit-touch-callout: none) {
  .pwa-prompt,
  .pwa-prompt-ios {
    display: none;
  }
}
/* ============================================================================
   DESKTOP FIX - Zapewnienie poprawnego układu w trybie symulacji telefonu
   ============================================================================ */
@media (min-width: 600px) {
  /* ✅ FIX 1: Sekcje muszą używać 100% zamiast 100vw */
  .webyx-section {
    width: 100%; /* Zmiana z 100vw na 100% */
    height: 100vh;
    height: var(--app-height);
  }
  /* ✅ FIX 2: Video musi mieć object-fit: cover i być w granicach kontenera */
  .player,
  .tiktok-symulacja video {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover; /* KRYTYCZNE: zapobiega rozciąganiu */
    object-position: center;
  }
  /* ✅ FIX 3: Iframe też musi być w granicach */
  .tiktok-symulacja iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  /* ✅ FIX 4: Sidebar - upewnij się że jest widoczny i dobrze pozycjonowany */
  .tiktok-symulacja .sidebar {
    display: flex; /* Wymuszenie widoczności */
    visibility: visible !important; /* Na wypadek gdyby coś go ukrywało */
  }
  /* ✅ FIX 5: Wszystkie overlay muszą używać 100% zamiast 100vw */
  .secret-overlay,
  .pwa-secret-overlay,
  .error-overlay,
  .pause-overlay,
  .replay-overlay {
    width: 100%;
  }
  /* ✅ FIX 6: Topbar i bottombar też muszą być w granicach */
  .topbar,
  .tiktok-symulacja .bottombar {
    width: 100%;
  }
  /* ✅ FIX 7: Login panel - dopasowanie do zwężonego kontenera */
  .login-panel {
    width: 100%;
  }
  /* ✅ FIX 8: Swiper wrapper - musi być w granicach */
  .swiper-wrapper {
    width: 100%;
  }
  /* ✅ FIX 9: Alert box - centrowanie w zwężonym kontenerze */
  #alertBox {
    left: 50%;
    transform: translateX(-50%);
    /* max-width jest teraz obsługiwany przez główną regułę z funkcją min() */
  }
  /* ✅ FIX 10: Video controls - zapewnienie widoczności */
  .video-controls {
    display: flex !important;
    z-index: 105;
  }
  /* ✅ FIX 11: Progress bar - pełna szerokość w kontenerze */
  .progress-bar {
    width: 100%;
    left: 0;
  }
  /* ✅ FIX 12: Bottombar text info - zapewnienie widoczności */
  .tiktok-symulacja .text-info {
    display: block;
    max-width: calc(100% - 80px); /* Odstęp od sidebara */
  }
}

/* ============================================================================
   DODATKOWE ZABEZPIECZENIA - dla wszystkich szerokości ekranu
   ============================================================================ */
/* Video zawsze z object-fit */
.player,
.tiktok-symulacja video {
  object-fit: cover;
  object-position: center;
}

/* Zapobieganie overflow */
.webyx-section,
.tiktok-symulacja {
  overflow: hidden;
}

/* Sidebar zawsze widoczny gdy video załadowane */
.tiktok-symulacja.video-loaded .sidebar {
  opacity: 1 !important;
  visibility: visible !important;
  display: flex !important;
}

/* ==========================================================================
   --- COMMENTS MODAL - COMPLETE REWRITE ---
   ========================================================================== */

#comments-modal-container.modal-overlay {
  align-items: flex-end;
  z-index: 10005;
  transition: visibility 0.3s ease-out;
}

#comments-modal-container .modal-content {
  background: #18191a;
  color: #e4e6eb;
  width: 100%;
  max-width: 100%;
  height: 75vh;
  max-height: 75vh;
  border-radius: 16px 16px 0 0;
  padding: 0;
  transform: translateY(100%);
  transition: transform 0.3s ease-out;
  display: flex;
  flex-direction: column;
  border-top: 1px solid rgba(255, 255, 255, 0.15);
  position: relative;
}

/* Gdy klawiatura jest widoczna */
#comments-modal-container.keyboard-visible .modal-content {
  height: calc(100vh - var(--keyboard-offset, 0px));
  max-height: calc(100vh - var(--keyboard-offset, 0px));
  transition: height 0.3s ease-out, max-height 0.3s ease-out;
}

#comments-modal-container.visible .modal-content {
  transform: translateY(0);
}

#comments-modal-container.is-hiding .modal-content {
  transform: translateY(100%);
}

#comments-modal-container.is-hiding .modal-content {
  transform: translateY(100%);
}

/* Header */
#comments-modal-container .modal-header {
    display: grid;
    grid-template-columns: 1fr auto 1fr;
    align-items: center;
    padding: 4px 8px;
    flex-shrink: 0;
    height: 40px;
    border-bottom: 1px solid #3a3b3c;
}

#comments-modal-container .modal-close-btn {
  color: #b0b3b8;
  opacity: 1;
  position: static;
  transform: none;
  width: 30px;
  height: 30px;
  font-size: 24px;
}

#comments-modal-container .modal-close-btn:hover {
  opacity: 1;
}

/* Body - scrollowalna lista */
#comments-modal-container .modal-body {
  flex: 1;
  min-height: 0;
  overflow-y: auto;
  overflow-x: hidden;
  padding: 8px;
  -webkit-overflow-scrolling: touch;
  transition: padding-bottom 0.3s ease-out;
}

#comments-modal-container.keyboard-visible .comment-form-container {
  box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.3);
}

/* Comment Form Container - ZAWSZE NA DOLE */
.comment-form-container {
  padding: 8px 12px;
  background: #18191a;
  border-top: 1px solid #3a3b3c;
  flex-shrink: 0;
  position: sticky;
  bottom: 0;
  left: 0;
  width: 100%;
  z-index: 10;
}

#comments-modal-container.keyboard-visible .comment-form-container {
  box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.3);
}

/* Reply Context */
.reply-context {
  padding: 8px 12px;
  background: rgba(255, 0, 85, 0.1);
  border-left: 3px solid var(--accent-color);
  font-size: 13px;
  color: #e4e6eb;
  display: none;
  justify-content: space-between;
  align-items: center;
  border-radius: 6px;
  margin-bottom: 8px;
  animation: slideDown 0.2s ease-out;
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.reply-context-text {
  flex: 1;
  font-weight: 500;
}

.cancel-reply-btn {
  background: none;
  border: none;
  font-size: 20px;
  cursor: pointer;
  color: #b0b3b8;
  padding: 0 4px;
  line-height: 1;
  transition: color 0.2s;
  margin-left: 8px;
}

.cancel-reply-btn:hover {
  color: #e4e6eb;
}

.cancel-reply-btn:active {
  transform: scale(0.9);
}

/* Comment Form */
#comment-form {
  display: flex;
  align-items: flex-end;
  gap: 8px;
}

.comment-input-wrapper {
  flex-grow: 1;
  position: relative;
  display: flex;
  align-items: flex-end;
  background: #242526;
  border: 1px solid #3a3b3c;
  border-radius: 18px;
  padding: 4px 4px 4px 12px;
  transition: border-color 0.2s;
}

.comment-input-wrapper:focus-within {
  border-color: var(--accent-color);
  box-shadow: 0 0 0 2px rgba(255, 0, 85, 0.1);
}

#comment-input {
  flex-grow: 1;
  border: none;
  background: transparent;
  padding: 6px 0;
  font-size: 15px;
  color: #e4e6eb;
  max-height: 120px;
  min-height: 24px;
  resize: none;
  overflow-y: auto;
  font-family: inherit;
  line-height: 1.4;
}

#comment-input:focus {
  outline: none;
}

#comment-input::placeholder {
  color: #b0b3b8;
}

/* Attachment Buttons */
.comment-attachments {
  display: flex;
  gap: 4px;
  align-items: center;
  padding: 0 4px;
}

.attachment-btn {
  background: none;
  border: none;
  cursor: pointer;
  padding: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #b0b3b8;
  transition: all 0.2s;
  border-radius: 50%;
}

.attachment-btn:hover {
  background: rgba(255, 255, 255, 0.1);
  color: #e4e6eb;
}

.attachment-btn:active {
  transform: scale(0.9);
}

.attachment-btn svg {
  width: 20px;
  height: 20px;
}

/* Submit Button */
#comment-form .submit-btn {
  background: none;
  border: none;
  cursor: pointer;
  padding: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--accent-color);
  transition: transform 0.1s ease;
  flex-shrink: 0;
  border-radius: 50%;
}

#comment-form .submit-btn:hover {
  background: rgba(255, 0, 85, 0.1);
}

#comment-form .submit-btn:active:not(:disabled) {
  transform: scale(0.9);
}

#comment-form .submit-btn:disabled {
  opacity: 0.4;
  cursor: not-allowed;
}

#comment-form .submit-btn svg {
  width: 24px;
  height: 24px;
}

/* Image Preview */
.image-preview-container {
  display: none;
  padding: 8px 0;
  animation: slideDown 0.2s ease-out;
}

.image-preview-container.visible {
  display: block;
}

.image-preview {
  position: relative;
  display: inline-block;
  max-width: 150px;
  border-radius: 8px;
  overflow: hidden;
  border: 2px solid #3a3b3c;
}

.image-preview img {
  width: 100%;
  height: auto;
  display: block;
}

.remove-image-btn {
  position: absolute;
  top: 4px;
  right: 4px;
  background: rgba(0, 0, 0, 0.7);
  border: none;
  border-radius: 50%;
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  color: white;
  font-size: 16px;
  transition: background 0.2s;
}

.remove-image-btn:hover {
  background: rgba(0, 0, 0, 0.9);
}

/* Emoji Picker */
.emoji-picker {
  position: absolute;
  bottom: 100%;
  left: 0;
  margin-bottom: 8px;
  background: #242526;
  border: 1px solid #3a3b3c;
  border-radius: 12px;
  padding: 8px;
  display: none;
  flex-wrap: wrap;
  gap: 4px;
  max-width: 280px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  z-index: 20;
  animation: slideUp 0.2s ease-out;
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.emoji-picker.visible {
  display: flex;
}

.emoji-item {
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  padding: 4px;
  border-radius: 6px;
  transition: background 0.2s;
  line-height: 1;
}

.emoji-item:hover {
  background: rgba(255, 255, 255, 0.1);
}

.emoji-item:active {
  transform: scale(0.9);
}

/* Comments List */
.comments-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
  padding: 8px 0;
}

.comment-item {
  display: flex;
  gap: 8px;
  align-items: flex-start;
  padding: 0;
  width: 100%;
}

.comment-avatar-wrapper {
  flex-shrink: 0;
}

.comment-avatar {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  flex-shrink: 0;
  object-fit: cover;
}

.comment-main {
  flex-grow: 1;
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.comment-body {
  background: #242526;
  border-radius: 18px;
  padding: 6px 10px;
}

.comment-user {
  font-weight: 600;
  font-size: 13px;
  color: #e4e6eb;
}

.comment-text {
  font-size: 14px;
  line-height: 1.3;
  color: #e4e6eb;
  margin: 0;
  white-space: pre-wrap;
  word-break: break-word;
}

/* Comment Image */
.comment-image {
  margin-top: 6px;
  max-width: 200px;
  border-radius: 8px;
  overflow: hidden;
  cursor: pointer;
  transition: transform 0.2s;
}

.comment-image img {
  width: 100%;
  height: auto;
  display: block;
}

.comment-image:hover {
  transform: scale(1.02);
}

.comment-footer {
  display: flex;
  align-items: center;
  gap: 10px;
  padding-left: 10px;
}

.comment-timestamp {
  font-size: 11px;
  color: #b0b3b8;
}

.comment-actions-wrapper {
  display: flex;
  gap: 8px;
}

.comment-action-btn,
.comment-reply-btn {
  background: none;
  border: none;
  cursor: pointer;
  color: #b0b3b8;
  font-weight: 600;
  padding: 0;
  font-size: 11px;
  transition: color 0.2s;
}

.comment-action-btn:hover,
.comment-reply-btn:hover {
  color: #e4e6eb;
}

.comment-likes {
  display: flex;
  align-items: center;
  gap: 4px;
}

.comment-like-btn {
  background: none;
  border: none;
  cursor: pointer;
  padding: 0;
  display: flex;
}

.comment-like-btn svg {
  width: 14px;
  height: 14px;
  stroke: #b0b3b8;
  stroke-width: 2;
  fill: none;
  transition: all 0.2s ease;
}

.comment-like-btn:hover svg {
  stroke: var(--accent-color);
}

.comment-like-btn.active svg {
  fill: var(--accent-color);
  stroke: var(--accent-color);
}

.comment-like-count {
  font-size: 11px;
  color: #b0b3b8;
  font-weight: 500;
}

/* Comment Threads */
.comment-thread {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.comment-replies {
  padding-left: 40px;
  display: none;
  flex-direction: column;
  gap: 12px;
  margin-top: 8px;
}

.comment-replies.visible {
  display: flex;
}

.toggle-replies-btn {
  background: none;
  border: none;
  cursor: pointer;
  color: #b0b3b8;
  font-weight: 600;
  padding: 2px 10px;
  font-size: 11px;
  transition: color 0.2s;
  display: flex;
  align-items: center;
  gap: 4px;
}

.toggle-replies-btn:hover {
  color: #e4e6eb;
}

.toggle-replies-btn .arrow {
  border: solid #b0b3b8;
  border-width: 0 2px 2px 0;
  display: inline-block;
  padding: 2px;
  transform: rotate(45deg);
  transition: transform 0.2s, border-color 0.2s;
}

.toggle-replies-btn:hover .arrow {
  border-color: #e4e6eb;
}

.toggle-replies-btn.expanded .arrow {
  transform: rotate(-135deg);
}

/* Sort Options */
.comment-sort-options {
  position: static;
  transform: none;
  z-index: 10;
  flex-shrink: 0;
}

.sort-dropdown {
  position: relative;
}

.sort-trigger {
  background: none;
  border: none;
  color: #b0b3b8;
  font-size: 13px;
  font-weight: 600;
  cursor: pointer;
  padding: 4px 8px;
}

.sort-trigger .current-sort {
  color: #e4e6eb;
}

.sort-options {
  display: none;
  position: absolute;
  top: 100%;
  left: 0;
  background: #242526;
  border: 1px solid #3a3b3c;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  padding: 4px;
  margin-top: 4px;
  width: 160px;
  z-index: 20;
}

.sort-dropdown.open .sort-options {
  display: block;
}

.sort-option {
  background: none;
  border: none;
  width: 100%;
  padding: 8px 12px;
  text-align: left;
  font-size: 14px;
  cursor: pointer;
  border-radius: 4px;
  color: #e4e6eb;
}

.sort-option:hover {
  background-color: #3a3b3c;
}

.sort-option.active {
  font-weight: 600;
  color: var(--accent-color);
}

/* No Comments Message */
.no-comments-message {
  text-align: center;
  padding: 60px 20px;
  color: #65676b;
  font-weight: 500;
}

/* Login Prompt */
.login-to-comment-prompt {
  align-items: center;
  background-color: #18191a;
  display: flex;
  justify-content: center;
  padding: 8px 12px;
  text-align: center;
}

.login-to-comment-prompt p {
  margin: 0;
  font-size: 15px;
  color: #e4e6eb;
}

.login-to-comment-prompt a {
  color: var(--accent-color);
  font-weight: 600;
  text-decoration: none;
  cursor: pointer;
}

/* Loading Spinner */
#comments-modal-container .modal-body .loading-spinner {
  display: block;
  margin: 60px auto;
  border-color: rgba(0, 0, 0, 0.2);
  border-top-color: var(--accent-color);
}

/* Image Lightbox */
.image-lightbox {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.95);
  z-index: 10100;
  display: none;
  align-items: center;
  justify-content: center;
  padding: 20px;
}

.image-lightbox.visible {
  display: flex;
}

.image-lightbox img {
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
  border-radius: 8px;
}

.image-lightbox-close {
  position: absolute;
  top: 20px;
  right: 20px;
  background: rgba(0, 0, 0, 0.7);
  border: none;
  color: white;
  font-size: 32px;
  width: 48px;
  height: 48px;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background 0.2s;
}

.image-lightbox-close:hover {
  background: rgba(0, 0, 0, 0.9);
}

/* Hidden File Input */
.comment-image-input {
  display: none;
}

/* ============================================================================
   --- NOWE: TRYB PEŁNEGO EKRANU (IMMERSYJNY) ---
   ============================================================================ */

/* Dodajemy płynne przejścia do animowanych elementów */
.tiktok-symulacja .bottombar,
.tiktok-symulacja .video-controls {
    transition: transform 0.3s ease-out, bottom 0.3s ease-out;
}

/* KROK 1: Całkowicie schowaj dolny pasek, gdy tryb immersyjny jest aktywny */
#app-frame.hide-ui .bottombar {
    transform: translateY(100%);
}

/* KROK 2: Przesuń kontrolki wideo na sam dół ekranu */
#app-frame.hide-ui .video-controls {
    bottom: calc(8px + var(--safe-area-bottom));
}

/* KROK 3: Sidebar nie jest już ukrywany. Pozostaje widoczny. */
/* Celowo usunięto regułę dla #app-frame.hide-ui .sidebar */

/* ✅ NOWE: Wyśrodkuj sidebar w pionie, gdy dolny pasek jest ukryty */
#app-frame.hide-ui .sidebar {
    top: calc((var(--app-height) - var(--topbar-height)) / 2 + var(--topbar-height));
}

/* ✅ NOWE: Aktywuj ikonę CC w trybie immersyjnym (bez zmiany tła) */
#app-frame.hide-ui .cc-button {
    opacity: 1;
    cursor: pointer;
}

#app-frame.hide-ui .cc-button:hover {
    transform: scale(1.1); /* Lekkie powiększenie dla feedbacku */
    background-color: rgba(0, 0, 0, 0.7); /* Delikatne przyciemnienie tła */
}

/* ✅ NOWE: Wyśrodkuj nakładki pauzy i powtórzenia w trybie immersyjnym */
.pause-overlay, .replay-overlay {
    transition: top 0.3s ease-out, height 0.3s ease-out, opacity 0.2s ease-in-out;
}

#app-frame.hide-ui .pause-overlay,
#app-frame.hide-ui .replay-overlay {
    top: var(--topbar-height);
    height: calc(100% - var(--topbar-height));
}

/* NOWE: Wizualne wyłączenie przycisku immersji w trybie przeglądarki */
@media not all and (display-mode: standalone) {
  .fullscreen-button {
    opacity: 0.5;
    cursor: not-allowed;
  }
}

/* NOWE: Domyślnie ukryj ikonę wyjścia z trybu immersyjnego */
.fullscreen-exit-icon {
  display: none;
}

/* ============================================================================
   ELEGANT MODAL STYLES (for Tipping, etc.)
   ============================================================================ */

.elegant-modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.6);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  display: flex !important;
  align-items: center;
  justify-content: center;
  z-index: 10020;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.4s ease, visibility 0.4s ease;
}

#tippingModal, #infoModal {
    display: flex;
    align-items: center;
    justify-content: center;
}

.elegant-modal-overlay.visible {
  opacity: 1;
  visibility: visible;
}

.elegant-modal-content {
  background: linear-gradient(180deg, #28282a 0%, #1c1c1e 100%);
  color: #f0f0f0;
  border-radius: 20px;
  width: 90%;
  max-width: 420px;
  display: flex;
  flex-direction: column;
  border: 1px solid rgba(255, 255, 255, 0.1);
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
  transform: scale(0.95) translateY(10px);
  opacity: 0;
  transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.4s ease;
}

.elegant-modal-overlay.visible .elegant-modal-content {
  transform: scale(1) translateY(0);
  opacity: 1;
}

.elegant-modal-header {
  padding: 20px 24px 16px;
  text-align: center;
  flex-shrink: 0;
  position: relative; /* Needed for the close button */
}

.elegant-modal-title {
  font-size: 20px;
  font-weight: 600;
  margin-bottom: 8px;
}

.elegant-modal-progress-bar-container {
  height: 5px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 2.5px;
  overflow: hidden;
}

.elegant-modal-progress-bar-fill {
  height: 100%;
  width: 33.33%;
  background: var(--accent-color);
  border-radius: 2.5px;
  transition: width 0.5s ease-in-out;
}

.elegant-modal-body {
  padding: 0 24px 20px;
  overflow: hidden; /* Steps will manage their own visibility */
  flex-grow: 1;
}

.elegant-modal-step {
  display: none;
  animation: elegantFadeIn 0.6s ease-out;
}

@keyframes elegantFadeIn {
  from { opacity: 0; transform: translateY(8px); }
  to { opacity: 1; transform: translateY(0); }
}

.elegant-modal-step.active {
  display: block;
  animation: elegantFadeIn 0.6s ease-out;
}

@keyframes elegantFadeIn {
  from { opacity: 0; transform: translateY(8px); }
  to { opacity: 1; transform: translateY(0); }
}

.elegant-modal-step-description {
  color: #b0b3b8;
  font-size: 15px;
  line-height: 1.5;
  margin-bottom: 12px;
  text-align: center;
}

.elegant-modal-fields-container {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.elegant-modal-input {
  background: rgba(0, 0, 0, 0.2);
  border: 1px solid rgba(255, 255, 255, 0.15);
  padding: 14px 16px;
  border-radius: 10px;
  color: #fff;
  font-size: 16px;
  transition: all 0.2s ease;
  width: 100%;
}

.elegant-modal-input:focus {
  outline: none;
  border-color: var(--accent-color);
  background: rgba(0, 0, 0, 0.3);
  box-shadow: 0 0 0 2px rgba(255, 0, 85, 0.2);
}

.elegant-modal-input::placeholder {
  color: #8e8e93;
}

.elegant-modal-preference-row {
  display: flex;
  align-items: center;
  gap: 12px;
  background: rgba(255, 255, 255, 0.05);
  padding: 14px 16px;
  border-radius: 10px;
  cursor: pointer;
  border: 1px solid transparent;
  transition: background-color 0.2s, border-color 0.2s;
  flex-direction: row-reverse;
}

.elegant-modal-preference-row:hover {
  background-color: rgba(255, 255, 255, 0.08);
  border-color: rgba(255, 255, 255, 0.1);
}

.elegant-modal-preference-label {
  color: #f0f0f0;
  font-size: 15px;
  font-weight: 500;
}

.elegant-modal-checkbox {
  transform: scale(1.3);
  accent-color: var(--accent-color);
  background-color: #333;
  border: 1px solid #555;
  border-radius: 4px;
}

.elegant-modal-email-container {
    transition: all 0.4s ease-in-out;
    opacity: 0;
    max-height: 0;
    overflow: hidden;
    margin-top: 0;
}

.elegant-modal-email-container.visible {
    opacity: 1;
    max-height: 100px;
    margin-top: 8px; /* small gap */
}

.elegant-modal-hint-text {
  font-size: 12px;
  color: #888;
  text-align: center;
  margin-top: 8px;
}

.tipping-amount-container .amount-input {
    flex-grow: 1;
    background: transparent;
    border: none;
    color: white;
    font-size: 24px;
    font-weight: 600;
    padding: 12px 16px;
    text-align: center;
    -moz-appearance: textfield; /* Firefox */
}

.tipping-amount-container .amount-input::-webkit-outer-spin-button,
.tipping-amount-container .amount-input::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
}

.tipping-currency {
    font-size: 20px;
    font-weight: 500;
    color: rgba(255, 255, 255, 0.5);
    padding-right: 20px;
}

.elegant-modal-footer {
  padding: 16px 24px;
  padding-bottom: calc(20px + var(--safe-area-bottom));
  border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.elegant-modal-footer-buttons {
  display: flex;
  gap: 12px;
}

.elegant-modal-btn {
  flex: 1;
  padding: 14px;
  border: none;
  border-radius: 12px;
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
}

.elegant-modal-btn:active {
  transform: scale(0.97);
}

.elegant-modal-btn-prev {
  background: #3a3a3c;
  color: #f0f0f0;
  display: none; /* Hidden by default */
}

.elegant-modal-btn-next,
.elegant-modal-btn-submit {
  color: #fff;
  box-shadow: 0 4px 15px rgba(255, 0, 85, 0.25);
}

.elegant-modal-btn-next {
    background: var(--accent-color);
}

.elegant-modal-btn-submit {
  background: #34c759; /* Green for payment */
  display: none; /* Hidden by default */
  box-shadow: 0 4px 15px rgba(52, 199, 89, 0.25);
}

.elegant-modal-btn:hover {
    filter: brightness(1.1);
}

/* ============================================================================
   ELEGANT MODAL STYLES (for Tipping, etc.) - ENHANCED UX/UI
   ============================================================================ */

/* ... (istniejące style .elegant-modal-overlay) ... */

.elegant-modal-content {
    /* ... (istniejące style) ... */
    /* NEW: Add subtle texture and depth */
    background: linear-gradient(175deg, #2D2D2F 0%, #1E1E20 100%);
    box-shadow: 0 15px 50px rgba(0, 0, 0, 0.6), 0 0 0 1px rgba(255, 255, 255, 0.08);
}

/* ... (istniejące style .elegant-modal-header) ... */

.elegant-modal-progress-bar-fill {
    /* ... (istniejące style) ... */
    /* NEW: Add a subtle glow and gradient */
    background: linear-gradient(90deg, var(--accent-color), #ff4081);
    box-shadow: 0 0 10px rgba(255, 0, 85, 0.5);
}

.elegant-modal-step.active {
    animation: elegantFadeIn 0.8s cubic-bezier(0.16, 1, 0.3, 1); /* Smoother animation */
}

@keyframes elegantFadeIn {
  from { opacity: 0; transform: translateY(12px) scale(0.98); }
  to { opacity: 1; transform: translateY(0) scale(1); }
}

/* ... (istniejące style .elegant-modal-step-description) ... */

.elegant-modal-input {
    /* ... (istniejące style) ... */
    /* NEW: Enhanced focus state */
    transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
}

/* NEW: Amount Suggestions */
.tipping-amount-suggestions {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 12px;
    margin-bottom: 16px;
}

.amount-suggestion-btn {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    color: #f0f0f0;
    padding: 14px;
    border-radius: 12px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
}

.amount-suggestion-btn:hover {
    background: rgba(255, 255, 255, 0.1);
    transform: translateY(-2px);
}

.amount-suggestion-btn.active {
    background: var(--accent-color);
    color: #fff;
    border-color: var(--accent-color);
    box-shadow: 0 0 15px rgba(255, 0, 85, 0.4);
    transform: translateY(-2px) scale(1.02);
}

/* NEW: Enhanced Amount Input */
.tipping-amount-container {
    background-color: rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all 0.3s ease;
}

.tipping-amount-container:focus-within {
    border-color: var(--accent-color);
    box-shadow: 0 0 0 3px rgba(255, 0, 85, 0.2);
}

#tippingAmount {
    font-size: 26px; /* Slightly larger */
    font-weight: 700;
}

.elegant-modal-btn {
    /* ... (istniejące style) ... */
    /* NEW: Enhanced button styles */
    transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.elegant-modal-btn:active {
    transform: scale(0.96);
}

.elegant-modal-btn-next,
.elegant-modal-btn-submit {
    /* NEW: Add gradient and subtle shadow */
    background: linear-gradient(90deg, var(--accent-color), #e6004d);
}

.elegant-modal-btn-submit {
    background: linear-gradient(90deg, #34c759, #28a745);
    box-shadow: 0 4px 15px rgba(52, 199, 89, 0.3);
}

.elegant-modal-btn:hover {
    filter: brightness(1.15);
    transform: translateY(-2px);
}

@media (min-width: 600px) {
  #infoModal.modal-overlay,
  #tippingModal.elegant-modal-overlay {
    /* This rule ensures that on desktop, the modal overlay takes up the full viewport
       width, allowing the content within to be properly centered horizontally,
       rather than being constrained to the simulated phone's width. */
    width: 100vw !important;
    left: 0 !important;
    right: 0 !important;
    margin: 0 !important;
    border: none !important;
  }
}


